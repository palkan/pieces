!function(){"use strict";var t="undefined"!=typeof window?window:global;if("function"!=typeof t.require){var e={},n={},r=function(t,e){return{}.hasOwnProperty.call(t,e)},i=function(t,e){var n,r,i=[];n=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var o=0,s=n.length;s>o;o++)r=n[o],".."===r?i.pop():"."!==r&&""!==r&&i.push(r);return i.join("/")},o=function(t){return t.split("/").slice(0,-1).join("/")},s=function(e){return function(n){var r=o(e),s=i(r,n);return t.require(s,e)}},u=function(t,e){var r={id:t,exports:{}};return n[t]=r,e(r.exports,s(t),r),r.exports},a=function(t,o){var s=i(t,".");if(null==o&&(o="/"),r(n,s))return n[s].exports;if(r(e,s))return u(s,e[s]);var a=i(s,"./index");if(r(n,a))return n[a].exports;if(r(e,a))return u(a,e[a]);throw new Error('Cannot find module "'+t+'" from "'+o+'"')},c=function(t,n){if("object"==typeof t)for(var i in t)r(t,i)&&(e[i]=t[i]);else e[t]=n},l=function(){var t=[];for(var n in e)r(e,n)&&t.push(n);return t};t.require=a,t.require.define=c,t.require.register=c,t.require.list=l,t.require.brunch=!0}}(),require.define({"pieces-core/components/base":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h,p,_,f,d={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},v=[].slice;u=e("./utils/klass"),s=e("./events"),c=e("../core/utils"),a=e("../core/nod").Nod,o=e("../grammar/compiler"),i=e("../core/binding").Bindable,l=/\[\]$/,_=function(t,e,n){return Object.defineProperty(t,e,n)},p={"default":function(t,e){return this.__properties__[t]!==e?(this.__properties__[t]=e,!0):!1},bool:function(t,e){return e=!!e,this.__properties__[t]!==e?(this.__properties__[t]=e,!0):!1}},f=function(t,e){return null!=e?e.on===t?this.addClass(e.name):this.removeClass(e.name):void 0},h=function(t,e){return null!=e?t===e.on?this.attr(e.name,e.name):this.attr(e.name,null):void 0},r=function(t){function e(t,n,r){this.node=t,this.host=n,this.options=null!=r?r:{},e.__super__.constructor.apply(this,arguments),this.preinitialize(),this.initialize(),this.init_plugins(),this.init_children(),this.setup_events(),this.postinitialize(),this.setup_bindings()}return y(e,t),e.include(i),e.include_plugins=function(){var t,e,n,r,i;for(e=1<=arguments.length?v.call(arguments,0):[],i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(t.included(this));return i},e.requires=function(){var t;return t=1<=arguments.length?v.call(arguments,0):[],this.before_create(function(){var e,n;for(n=[];t.length;){if(e=t.pop(),void 0===this[e])throw Error("Missing required component "+e);n.push(void 0)}return n})},e.active_property=function(t,e,n){var r,i;return null==n&&(n={}),t.__prop_desc__=c.clone(t.__prop_desc__||{}),n.type||(n.type="default"),null!=n["class"]&&"string"==typeof n["class"]&&(n["class"]={name:n["class"],on:!0}),null!=n.node_attr&&"string"==typeof n.node_attr&&(n.node_attr={name:n.node_attr,on:!0}),t.__prop_desc__[e]=n,r={get:function(){return this.__properties__[e]}},n.readonly?r.writable=!1:r.set=function(t){return p[n.type].call(this,e,t)&&(t=this.__properties__[e],f.call(this,t,n["class"]),h.call(this,t,n.node_attr),null!=n.event&&this.trigger(n.event,t),this.trigger("change:"+e)),t},"bool"===n.type&&(null!=n.functions&&(t[n.functions[0]]=function(){return this[e]=!0,this},t[n.functions[1]]=function(){return this[e]=!1,this}),n.toggle&&(i="string"==typeof n.toggle?n.toggle:"toggle_"+e,t[i]=function(t){return null==t&&(t=null),this[e]=null===t?!this[e]:t,this})),_(t,e,r)},e.prototype.preinitialize=function(){var t,e,n,r,i;a.store(this,!0),this.__properties__={},this.__components__=[],this.__plugins__=[],this.pid=this.data("pid")||this.attr("pid")||this.node.id,this.options.scoped&&(this.scope={scope:this}),(null!=(n=this.host)?n.scoped:void 0)===!0&&(this.scope||(this.scope=this.host.scope)),this.scoped=null!=this.scope,r=this.__prop_desc__,i=[];for(e in r)d.call(r,e)&&(t=r[e],i.push(function(t){return function(e,n){return t.__properties__[e]=n["default"]}}(this)(e,t)));return i},e.prototype.initialize=function(){return(this.options.disabled||this.hasClass(u.DISABLED))&&this.disable(),(this.options.hidden||this.hasClass(u.HIDDEN))&&this.hide(),(this.options.active||this.hasClass(u.ACTIVE))&&this.activate(),this._initialized=!0,this.trigger(s.Initialized,!0,!1)},e.register_callback("initialize"),e.prototype.init_plugins=function(){var t,e,n;n=this.options.plugins;for(t in n)d.call(n,t)&&(e=n[t],this.attach_plugin(this.constructor.lookup_module(t),e))},e.prototype.attach_plugin=function(t,e){return null!=t?(c.debug_verbose("plugin attached "+t.prototype.id),this.__plugins__.push(t.attached(this,e))):void 0},e.prototype.init_children=function(){var t,e,n,r,i;for(i=this.find_cut("."+u.PI),e=function(t){return function(e){var n;return n=a.create(e).piecify(t),t.add_component(n)}}(this),n=0,r=i.length;r>n;n++)t=i[n],e(t)},e.prototype.setup_events=function(){var t,e,n,r,i,s,u;s=this.options.events;for(t in s)if(d.call(s,t))for(n=s[t],u=n.split(/;\s*/),r=0,i=u.length;i>r;r++)e=u[r],this.on(t,o.str_to_event_handler(e,this));delete this.options.events},e.prototype.postinitialize=function(){return this.trigger(s.Created,!0,!1)},e.register_callback("postinitialize",{as:"create"}),e.prototype.setup_bindings=function(){var t,e,n,r;n=this.options.bindings,r=[];for(e in n)d.call(n,e)&&(t=n[e],r.push(this.bind(e,t)));return r},e.prototype.piecify=function(){var t,e,n,r;for(this.__components__.length=0,this.init_children(),r=this.__components__,e=0,n=r.length;n>e;e++)t=r[e],t.piecify(this);return this},e.prototype.trigger=function(t,n,r){return this._initialized&&(this.enabled||t===s.Enabled)||t===s.Destroyed?e.__super__.trigger.call(this,t,n,r):void 0},e.prototype.bubble_event=function(t){return null!=this.host?this.host.trigger(t):void 0},e.active_property(e.prototype,"visible",{type:"bool","default":!0,event:s.Hidden,"class":{name:u.HIDDEN,on:!1},functions:["show","hide"]}),e.active_property(e.prototype,"enabled",{type:"bool","default":!0,event:s.Enabled,"class":{name:u.DISABLED,on:!1},functions:["enable","disable"]}),e.active_property(e.prototype,"active",{type:"bool","default":!0,event:s.Active,"class":{name:u.ACTIVE,on:!1},functions:["activate","deactivate"]}),e.prototype.dispose=function(){var t,n,r,i;if(!this._disposed){for(this._initialized=!1,null!=this.host&&this.host.remove_component(this),i=this.__plugins__,n=0,r=i.length;r>n;n++)t=i[n],t.dispose();return this.__plugins__.length=0,this.__components__.length=0,this.__properties__={},this.trigger(s.Destroyed,!0,!1),e.__super__.dispose.apply(this,arguments)}},e.prototype.add_component=function(t){var e,n;return(null!=t?t.pid:void 0)&&(l.test(t.pid)?(n=t.pid.slice(0,-2),e=this[n]||(this[n]=[]),this.scoped===!0&&(this.scope[n]=e),e.indexOf(t)>-1||e.push(t)):(this[t.pid]=t,this.scoped===!0&&(this.scope[t.pid]=t))),this.__components__.push(t),this.trigger(s.ChildAdded,t,!1)},e.prototype.remove_component=function(t){var e;if(t.pid)return e=t.pid,l.test(t.pid)&&(e=t.pid.slice(0,-2)),delete this[e],this.scoped===!0&&delete this.scope[e],this.__components__.splice(this.__components__.indexOf(t),1)},e.prototype.remove_children=function(){var t,n,r,i;for(n=this.__components__.slice(),r=0,i=n.length;i>r;r++)t=n[r],this.remove_component(t),t.remove();return e.__super__.remove_children.apply(this,arguments)},e}(a),n.exports=r}}),require.define({"pieces-core/components/base_input":function(t,e,n){"use strict";var r,i,o,s,u,a,c={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=e("./base"),o=e("./events"),s=e("../core/utils"),u=function(t){return t},a=function(t){return s.serialize(t)},i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.postinitialize=function(){return this.input||(this.input="INPUT"===this.node.nodeName?this:this.find("input")),this._serializer=this.options.serialize===!0?a:u,null==this.options.default_value||s.serialize(this.value())?void 0:this.value(this.options.default_value)},e.active_property(e.prototype,"val",{"default":""}),e.prototype.value=function(t){return null!=t?(this.input.node.value=t,this.val=this._serializer(t),this):this._serializer(this.input.node.value)},e.prototype.clear=function(t){return null==t&&(t=!1),this.value(null!=this.options.default_value?this.options.default_value:""),t?void 0:this.trigger(o.InputEvent.Clear)},e}(r),n.exports=i}}),require.define({"pieces-core/components/events/index":function(t,e,n){var r=e("./pi_events"),i=e("../../core/utils");i.extend(r,e("./input_events")),n.exports=r}}),require.define({"pieces-core/components/events/input_events":function(t,e,n){"use strict";n.exports={InputEvent:{Change:"changed",Input:"user_input",Clear:"cleared",Editable:"editable"},FormEvent:{Update:"updated",Submit:"submited",Invalid:"invalid"}}}}),require.define({"pieces-core/components/events/pi_events":function(t,e,n){"use strict";n.exports={Initialized:"initialized",ChildAdded:"child_added",Created:"creation_complete",Destroyed:"destroyed",Enabled:"enabled",Hidden:"hidden",Active:"active",Selected:"selected",Update:"update"}}}),require.define({"pieces-core/components/form":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h,p,_={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)_.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=e("./base"),o=e("./events"),l=e("./utils/validator"),h=e("../core/utils"),u=e("../core/former/former"),c=e("../core/nod").Nod,i=e("./base_input"),a=e("./utils/klass"),p=function(t){return t.indexOf("[]")>-1},s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.postinitialize=function(){return e.__super__.postinitialize.apply(this,arguments),this._cache={},this._value={},this._invalids=[],this.former=new u(this.node,this.options),this.read_values(),this.on(o.InputEvent.Change,function(t){return function(e){return e.cancel(),t.validate_nod(e.target)?t.update_value(e.target.name(),e.data):void 0}}(this)),this.on("change",function(t){return function(e){return h.is_input(e.target.node)&&t.validate_nod(e.target)?t.update_value(e.target.node.name,t.former._parse_nod_value(e.target.node)):void 0}}(this)),this.form="FORM"===this.node.nodeName?this:this.find("form"),null!=this.form?this.form.on("submit",function(t){return function(e){return e.cancel(),t.submit()}}(this)):void 0},e.prototype.submit=function(){return this.read_values(),this.validate()===!0?this.trigger(o.FormEvent.Submit,this._value):void 0},e.prototype.value=function(t){return null!=t?(this._value={},this.former.traverse_nodes(this.node,function(e){return function(n){return e.fill_value(n,t)}}(this)),this.read_values(),this):this._value},e.prototype.clear=function(t){return null==t&&(t=!1),this._value={},this.former.traverse_nodes(this.node,function(t){return function(e){return t.clear_value(e)}}(this)),this.former.options.clear_hidden===!1&&this.read_values(),t?void 0:this.trigger(o.InputEvent.Clear)},e.prototype.read_values=function(){var t;return t=[],this.former.traverse_nodes(this.node,function(e){return function(n){var r;return(r=c.fetch(n._nod))instanceof i&&r.name()?(p(name)||(e._cache[r.name()]=r),t.push({name:r.name(),value:r.value()})):h.is_input(n)&&n.name?(p(n.name)||(e._cache[n.name]=c.create(n)),t.push({name:n.name,value:e.former._parse_nod_value(n)})):void 0}}(this)),this._value=this.former.process_name_values(t)},e.prototype.find_by_name=function(t){var e;return null!=this._cache[t]?this._cache[t]:(e=this.find("[name="+t+"]"),null!=e?this._cache[t]=e:void 0)},e.prototype.fill_value=function(t,e){var n;if((n=c.fetch(t._nod))instanceof i&&n.name()){if(e=this.former._nod_data_value(n.name(),e),null==e)return;return n.value(e)}return h.is_input(t)?this.former._fill_nod(t,e):void 0},e.prototype.validate=function(){return this.former.traverse_nodes(this.node,function(t){return function(e){return t.validate_value(e)}}(this)),this._invalids.length?(this.trigger(o.FormEvent.Invalid,this._invalids),!1):!0},e.prototype.validate_value=function(t){var e;return(e=c.fetch(t._nod))instanceof i?this.validate_nod(e):void 0},e.prototype.validate_nod=function(t){var e,n,r,i,o,s;if(r=t.data("validates")){for(e=!0,s=r.split(" "),i=0,o=s.length;o>i;i++)if(n=s[i],!l.validate(n,t,this)){t.addClass(a.INVALID),e=!1;break}return e?(t.removeClass(a.INVALID),t.__invalid__&&(this._invalids.splice(this._invalids.indexOf(t.name()),1),delete t.__invalid__),!0):(null==t.__invalid__&&this._invalids.push(t.name()),t.__invalid__=!0,!1)}return!0},e.prototype.clear_value=function(t){var e;return(e=c.fetch(t._nod))instanceof i?e.clear():h.is_input(t)?this.former._clear_nod(t):void 0},e.prototype.update_value=function(t,e,n){return null==n&&(n=!1),t&&(t=this.former.transform_name(t),e=this.former.transform_value(e),p(t)!==!0)?(h.obj.set_path(this._value,t,e),n?void 0:this.trigger(o.FormEvent.Update,this._value)):void 0},e}(r),n.exports=s}}),require.define({"pieces-core/components/index":function(t,e,n){"use strict";var r={};r.Events=e("./events"),r.Base=e("./base"),e("./utils/binding"),r.BaseInput=e("./base_input"),r.TextInput=e("./text_input"),r.Form=e("./form"),n.exports=r}}),require.define({"pieces-core/components/modules/renderable":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=e("../../core/utils"),i=e("../../core/nod").Nod,r=e("../../core/core"),s=e("../../renderers"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.included=function(t){return t.getset("renderer",function(){return this.__renderer__||(this.__renderer__=this._find_renderer())},function(t){return this.__renderer__=t})},e.prototype.render=function(t){var e,n;return n=this.renderer,this.remove_children(),null!=t&&(e=n.render(t,!1),null!=e?(this.append(e),this.piecify()):u.error("failed to render data for: "+this.pid+"}",t)),this},e.prototype._find_renderer=function(){var t,e,n,r,i,o,a;if(null!=this.options.renderer&&_renderer_reg.test(this.options.renderer)){if(a=this.options.renderer.match(_renderer_reg),o=a[0],e=a[1],n=a[2],t=s[u.camelCase(e)],null!=t)return new t(n)}else if(i=this.find(".pi-renderer"))return r=new s.Simple(i,this.options.tpl_tag||i.data("tag")),i.remove(),r;return new s.Base},e}(r),n.exports=o}}),require.define({"pieces-core/components/text_input":function(t,e,n){"use strict";var r,i,o,s,u,a,c={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=e("./base"),o=e("./events"),a=e("../core/utils"),i=e("./base_input"),s=e("./utils/klass"),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.postinitialize=function(){return e.__super__.postinitialize.apply(this,arguments),this.editable=!0,(this.options.readonly||this.hasClass(s.READONLY))&&this.readonly(),this.input.on("change",function(t){return function(e){return e.cancel(),t.trigger(o.InputEvent.Change,t.value())}}(this)),this.input.on("input",function(t){return function(e){return e.cancel(),t.val=t.value(),t.trigger(o.InputEvent.Input,t.val)}}(this))},e.active_property(e.prototype,"editable",{type:"bool","default":!0,event:o.InputEvent.Editable,"class":{name:s.READONLY,on:!1},node_attr:{name:"readonly",on:!1}}),e.prototype.readonly=function(t){return null==t&&(t=!0),this.editable=!t},e}(i),n.exports=u}}),require.define({"pieces-core/components/utils/binding":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=e("../../core/utils"),a=e("../../core/utils/func"),i=e("../../core/binding").BindListener,u=e("../events"),r=e("../base"),s=e("../../core/core"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.included=function(t){return t.prototype._check_target=a.prepend(t.prototype._check_target,this.prototype.handle_root,{break_with:!1})},e.prototype.handle_component=function(t,e,n,r){if(c.debug("component",t,e,n,r),n?this.listeners.push.apply(this.listeners,t.on(u.Destroyed,function(t){return function(){return t.dispose()}}(this))):null!=t&&this.listeners.push.apply(this.listeners,t.on(u.Destroyed,this._disable)),r)return!0;if(t.__prop_desc__[e])c.debug("bindable",t,e),this.listeners.push.apply(this.listeners,t.on("change:"+e,this._update));else if(null==t[e])return c.debug("create",t,e),this.listeners.push.apply(this.listeners,t.on(u.ChildAdded,this._init,t,function(t){return t.data.pid===e})),void this.failed++;return!0},e.prototype.handle_root=function(t,e,n,i){var o,s;if(n&&null==t&&this.target instanceof r&&this.target.scoped)return o=this.steps[0].name,s=this.target.scope.scope,c.debug("create scoped",o),this.listeners.push.apply(this.listeners,s.on(u.ChildAdded,this._init,s,function(t){return t.data.pid===o})),this.failed++,a.BREAK},e}(s),i.prepend_type("component",function(t){return t instanceof r}),i.include(o),n.exports=i}}),require.define({"pieces-core/components/utils/guesser":function(t,e,n){"use strict";var r,i,o=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},s={}.hasOwnProperty;i=e("../../core/utils"),r=function(){function t(){}return t.klasses=[],t.klass_reg=null,t.klass_to_component={},t.tag_to_component={},t.specials={},t.compile_klass_reg=function(){return this.klass_reg=this.klasses.length?new RegExp("("+this.klasses.map(function(t){return"(\\b"+i.escapeRegexp(t)+"\\b)"}).join("|")+")","g"):null},t.rules_for=function(t,e,n,r){var i,o,s,u,a,c,l;if(null==e&&(e=[]),null==n&&(n=[]),e.length){for(u=0,c=e.length;c>u;u++)i=e[u],this.klass_to_component[i]=t,this.klasses.push(i);this.compile_klass_reg()}if(n.length)for(a=0,l=n.length;l>a;a++)o=n[a],((s=this.tag_to_component)[o]||(s[o]=[])).push(t);return"function"==typeof r?this.specials[t]=r:void 0},t.find=function(t){var e,n,r,u,a,c,l,h,p,_,f,d,y,v;if(u=[],this.klass_reg&&(d=t.node.className.match(this.klass_reg))&&(u=i.arr.uniq(d),1===u.length))return this.klass_to_component[u[0]];if(u=u.map(function(t){return function(e){return t.klass_to_component[e]}}(this)),c=t.node.nodeName.toLowerCase(),"input"===c&&(c+="["+t.node.type+"]"),null!=this.tag_to_component[c]){if(l=[],u.length)for(y=this.tag_to_component[c],h=0,_=y.length;_>h;h++)e=y[h],o.call(u,e)>=0&&l.push(e);else l=this.tag_to_component[c];if(l=i.arr.uniq(l),1===l.length)return l[0];u=l}if(u.length){for(p=0,f=u.length;f>p;p++)if(n=u[p],null!=this.specials[n]&&this.specials[n].call(null,t))return n;return u[u.length-1]}v=this.specials;for(r in v)if(s.call(v,r)&&(a=v[r],a.call(null,t)))return r;return"base"},t}(),n.exports=r}}),require.define({"pieces-core/components/utils/initializer":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h,p,_;u=e("./guesser"),c=e("../../core/nod").Nod,s=e("../../core/config"),o=e("../"),r=e("../../grammar/compiler"),l=e("../../core/utils"),p=/^on_(.+)/i,h=/^bind_(.+)/i,_=/^(\w+)(\(.*\))?$/,a=function(){function t(){}return t.builders=[],t.append_builder=function(t){return this.builders.push(t)},t.insert_builder_at=function(t,e){return this.builders.splice(e,0,t)},t.insert_builder_before=function(t,e){var n;return(n=this.builders.indexOf(e))>-1?this.insert_builder_at(t,n):this.append_builder(t)},t.insert_builder_after=function(t,e){var n;return(n=this.builders.indexOf(before_builder))>-1?this.insert_builder_at(t,n+1):this.append_builder(t)},t.init=function(t,e){var n,r,i,o;for(t=t instanceof c?t:c.create(t),o=this.builders,r=0,i=o.length;i>r;r++)if(n=o[r],n.match(t))return n.build(t,e)},t.gather_options=function(t,e){var n,r,i,o;null==e&&(e="base"),i=l.clone(t.data()),i.plugins=null!=i.plugins?this.parse_modules(i.plugins.split(/\s+/)):{},i.events={},i.bindings={};for(n in i)o=i[n],(r=n.match(p))&&(i.events[r[1]]=o),(r=n.match(h))&&(i.bindings[r[1]]=o);return l.merge(l.obj.get_path(s,e)||{},i)},t.parse_modules=function(t){var e,n,i,o,s;for(e={},i=function(t){var n,i,o,s,u;return n=t.match(_),null!=n?(u=n[0],i=n[1],s=n[2],null!=s&&(o=r.compile_fun(s).call()),e[i]=o):void 0},o=0,s=t.length;s>o;o++)n=t[o],i(n);return e},t}(),i=function(){function t(){}return t.match=l.truthy,t.build=function(t,e){var n;return n=this.guess_component(t),null!=n?t instanceof n?t:new n(t.node,e,a.gather_options(t,"components."+n.class_name)):void 0},t.guess_component=function(t){var e,n;return n=t.data("component")||u.find(t),e=l.obj.get_class_path(o,n),null==e?l.error("Unknown component "+n,t.data()):(e.class_name=n,l.debug_verbose("Component created: "+n),e)},t}(),a.append_builder(i),n.exports=a}}),require.define({"pieces-core/components/utils/klass":function(t,e,n){"use strict";var r;r={PI:"pi",DISABLED:"is-disabled",HIDDEN:"is-hidden",ACTIVE:"is-active",READONLY:"is-readonly",INVALID:"is-invalid",SELECTED:"is-selected",EMPTY:"is-empty"},n.exports=r}}),require.define({"pieces-core/components/utils/setup":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h,p;s=e("../../core/events").EventDispatcher,c=e("../../core/nod").Nod,u=e("./initializer"),a=e("./klass"),o=e("../../grammar/compiler"),p=e("../../core/utils"),i=e("../../core/app"),h=function(t,e){return u.init(t,e||t.parent(a.PI))},s.Global=new s,c.root=new c.Root,c.root.initialize(),l=function(t,e){return p.obj.get_path(window.pi.app.view,t)},p.extend(c.prototype,{piecify:function(t){return h(this,t)},pi_call:function(t,e){return this._pi_call&&this._pi_action===e||(this._pi_action=e,this._pi_call=o.str_to_fun(e,t)),this._pi_call.call(null)}}),c.root.ready(function(){return c.root.listen("a","click",function(t){var e;(e=t.target.attr("href"))&&"@"===e[0]&&(t.cancel(),p.debug("handle pi click: "+t.target.attr("href")),t.target.pi_call(t.target,t.target.attr("href")))})}),r=function(t){return"@"===t[0]?l(t.slice(1)):p.is_html(t)?c.create(t):c.root.find(t)},n.exports=r}}),require.define({"pieces-core/components/utils/validator":function(t,e,n){"use strict";var r,i,o;i=e("../../core/utils"),o=/(\w+)(?:\(([\w\-\/]+)\))/,r=function(){function t(){}return t.add=function(t,e){return this[t]=e},t.validate=function(t,e,n){var r,s;return(s=t.match(o))&&(t=s[1],r=i.serialize(s[2])),this[t](e.value(),e,n,r)},t.email=function(t){return i.is_email(t)},t.len=function(t,e,n,r){return(t+"").length>=r},t.truth=function(t){return!!i.serialize(t)},t.presence=function(t){return t&&(t+"").length>0},t.digital=function(t){return i.is_digital(t+"")},t.confirm=function(t,e,n){var r,i;return i=e.name().replace(/([\]]+)?$/,"_confirmation$1"),r=n.find_by_name(i),null==r?!1:r.value()===t},t}(),n.exports=r}}),require.define({"pieces-core/controllers/base":function(t,e,n){"use strict";var r,i,o,s={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("./context"),o=e("../core/utils"),r=function(t){function e(t){e.__super__.constructor.call(this,t),this.init_modules()}return u(e,t),e.prototype.id="base",e.prototype.set_view=function(t){return this.view=t,this.view.controller=this,this},e.prototype.init_modules=function(t){var e,n,r,i;r=this.options.modules,i=[];for(e in r)n=r[e],i.push(this.mixin(this.constructor.lookup_module(e)));return i},e.prototype.load=function(t){var n;return null==t&&(t={}),n=e.__super__.load.apply(this,arguments),this.view.loaded(t.params),n},e.prototype.activate=function(t){null==t&&(t={}),this.view.activated(t.params)},e.prototype.deactivated=function(){this.view.deactivated()},e.prototype.unload=function(){this.view.unloaded()},e.prototype.exit=function(t){return this.host_context.switch_back(t)},e.prototype["switch"]=function(t,e){return this.host_context.switch_context(this.id,t,e)},e}(i),n.exports=r}}),require.define({"pieces-core/controllers/context":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("../core/core"),u=e("../core/utils"),o=e("../core/utils/history"),r=function(t){function e(t){this.options=null!=t?t:{},e.__super__.constructor.apply(this,arguments),this.options.strategy&&(this.strategy=s.get(this.options.strategy),this.mixin(this.strategy)),this.preinitialize()}return c(e,t),e.prototype.preinitialize=function(){return this._contexts={}},e.register_callback("postinitialize",{as:"create",only:"after"}),e.prototype.add_context=function(t,e){var n;return null==e&&(e={}),this._contexts[null!=(n=e.as)?n:t.id]=t,t.host_context=this},e.prototype.initialize=function(){return this._initialized=!0},e.register_callback("initialize"),e.prototype.load=function(){var t;return this._initialized||this.initialize(),u.promise.as(null!=(t=this.strategy)?t.load(this):void 0)},e.register_callback("load"),e.prototype.unload=function(){var t;return null!=(t=this.strategy)?t.unload(this):void 0},e.register_callback("unload"),e.prototype.activate=function(){},e.prototype.deactivate=function(){},e.prototype.has_context=function(t){return!!this._contexts[t]},e.prototype.dispose=function(){var t;return this._initialized=!1,this._contexts={},null!=(t=this.strategy)?t.dispose(this):void 0},e}(i),s=function(){function t(){}return t.storage={},t.register=function(t,e){return this.storage[t]=e},t.get=function(t){return this.storage[t]},t}(),s.OneForAll=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.mixedin=function(t){return t._history=new o},e.load=function(t){var e;return this.context=t,this.context.context||this.__loading?void 0:(e=this.context.options["default"]||"main")&&this.context.has_context(e)?this.context.__loading_promise=this.context.switch_to(e).then(function(t){return function(){return t.context.context=t.context._contexts[e],t.context.context_id=e,delete t.context.__loading_promise}}(this),function(t){return function(e){throw delete t.context.__loading_promise,u.error(e),e}}(this)):void 0},e.unload=function(t){return this.context=t,(this.context.__loading_promise||u.promise.resolved()).then(function(t){return function(){var e;return null!=(e=t.context.context)?e.unload():void 0}}(this))},e.dispose=function(t){return this.context=t,this.context._history=new o,delete this.context.context,delete this.context.context_id,delete this.context.__loading_promise},e.prototype.switch_to=function(t,e,n){var r,i,o,s;return null==n&&(n=!1),t&&this._contexts[t]?(r={from:this.context_id,params:e},o=this._contexts[t],i=null!=(s="function"==typeof o.preload?o.preload():void 0)?s:u.promise.resolved(),i.then(function(e){return function(){var i;return null!=(i=e.context)&&i.unload(),o.load(r),n||e._history.push(t),e.context=o,e.context_id=t}}(this))):u.promise.rejected("Undefined target context: "+t)},e.prototype.switch_back=function(t){var e;return e=this._history.prev(),e?this.switch_to(e,t,!0):u.promise.resolved()},e.prototype.switch_forward=function(t){var e;return e=this._history.next(),e?this.switch_to(e,t,!0):u.promise.resolved()},e}(i),s.OneByOne=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.switch_to=function(t,e,n,r){var i,o,s,a,c,l;return null==n&&(n=!1),null==r&&(r=!0),!t||"string"==typeof t&&!this._contexts[t]?u.promise.rejected("Undefined target context: "+t):(c="object"==typeof t?[t.id,t.up]:[t,r],a=c[0],r=c[1],i={from:this.context_id,params:e},s=this._contexts[a],o=null!=(l="function"==typeof s.preload?s.preload():void 0)?l:u.promise.resolved(),o.then(function(t){return function(){var e,o;return r?(null!=(e=t.context)&&e.deactivate(),s.load(i)):(null!=(o=t.context)&&o.unload(),s.activate(i)),n||t._history.push({id:a,up:r}),t.context=s,t.context_id=a}}(this)))},e.prototype.switch_up=function(t,e){return this.switch_to(t,e)},e.prototype.switch_down=function(t,e){return this.switch_to(t,e,!1,!1)},e.prototype.switch_forward=s.OneForAll.prototype.switch_forward,e.prototype.switch_back=function(t){var e,n;return(n=this._history.prev())?(e=u.merge(n,{up:!n.up}),this.switch_to(e,t,!0)):u.promise.resolved()},e}(s.OneForAll),s.AllForOne=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.load=function(t){var e,n,r,i;this.context=t,r=this.context._contexts,i=[];for(n in r)a.call(r,n)&&(e=r[n],i.push(e.load()));return i},e.unload=function(t){var e,n,r,i;this.context=t,r=this.context._contexts,i=[];for(n in r)a.call(r,n)&&(e=r[n],i.push(e.unload()));return i},e.dispose=function(t){this.context=t},e.prototype.context=function(t){return this._contexts[t]},e}(i),s.register("one_for_all",s.OneForAll),s.register("one_by_one",s.OneByOne),s.register("all_for_one",s.AllForOne),n.exports=r}}),require.define({"pieces-core/controllers/index":function(t,e,n){"use strict";var r={};r.Context=e("./context"),r.Page=e("./page"),r.Base=e("./base"),n.exports=r}}),require.define({"pieces-core/controllers/initializer":function(t,e,n){"use strict";var r,i,o,s,u,a,c;o=e("./index"),c=e("../core/utils"),r=e("../views/base"),a=e("../views"),s=e("../components/utils/initializer"),u=e("./page"),i=function(){function t(){}return t.match=function(t){return!!t.data("controller")},t.build=function(t,e){var n,i,l,h,p,_,f,d,y,v,g,m,b;return _=s.gather_options(t),n=_.controller.split(/\s*\|\s*/),l=n[0]||"base",i=c.obj.get_class_path(o,l),null==i?c.error("Unknown controller "+_.controller):(f=null!=(g=null!=(m=_.view)?m.split(/\s*\|\s*/):void 0)?g:[l],v=f[0]||l,y=c.obj.get_class_path(a,v)||r,delete _.view,delete _.controller,_.modules=s.parse_modules((n[1]||"").split(/\s+/)),h=new i(c.clone(_)),delete _.strategy,delete _["default"],c.extend(_.modules,s.parse_modules((f[1]||"").split(/\s+/)),!0),d=new y(t.node,e,_),h.set_view(d),p=(b=e.view)?b.controller:u.instance,p.add_context(h,{as:d.pid}),d)},t}(),s.insert_builder_at(i,0),n.exports=i}}),require.define({"pieces-core/controllers/page":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=e("./context"),u=e("../core/utils"),i=e("../core/config"),r=e("../grammar/compiler"),s=function(t){function e(){this.constructor.instance=this,e.__super__.constructor.call(this,u.merge({strategy:"one_for_all","default":"main"},i.page))}return c(e,t),e.instance=null,e}(o),r.modifiers.push(function(t){return"@@"===t.slice(0,2)&&(t="@app.page.context."+t.slice(2)),t}),n.exports=s}}),require.define({"pieces-core/core/app":function(t,e,n){"use strict";var r,i,o,s;i=e("./nod").Nod,o=e("../controllers/page"),s=e("./utils"),r=function(){function t(){}return t.prototype.initialize=function(t){return this._initialized?!1:(this.page=new o,this.view=(null!=t?t:i.root).piecify(),this._initialized=!0,this.page.load())},t.prototype.reinitialize=function(){return this._initialized?(this.page.dispose(),this.view.piecify(),this.page.load()):!1},t.prototype.dispose=function(){return this._initialized?(this.page.dispose(),this.view.remove_children(),!0):!1},t}(),n.exports=r}}),require.define({"pieces-core/core/binding":function(t,e,n){"use strict";var r,i,o,s,u,a,t,c,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=e("./utils"),u=e("./core"),s=e("../grammar/compiler"),a=e("./events").EventDispatcher,t={},o=function(){
function t(t,e,n){this.target=t,this.expression=n,this.callback="function"==typeof this.target[e]?this.target[e].bind(this.target):function(t){return function(n){return t.target[e]=n}}(this),this.compiled=s.compile_fun(this.expression,this.target),this.ast=this.compiled._parsed,this.initialized=!1,this._disposed=!1,this.listeners=[],this.initialize(),this.invalidate()}return t.prototype.initialize=function(){var t,e,n,r;if(!this._disposed){for(e=[],s.traverse(this.ast,function(t){return"chain"===t.code?e.push(t):void 0}),n=0,r=e.length;r>n;n++)t=e[n],this.process_chain(t.value);return this.initialized=!0}},t.prototype.process_chain=function(t){return this.listeners.push(new r(this,this.target,t))},t.prototype.invalidate=function(){var t,e,n,r,i;if(this.initialized){for(e=!0,i=this.listeners,n=0,r=i.length;r>n;n++){if(t=i[n],t._disposed)return this.dispose();e=e&&t.enabled}return(e||e!==this.enabled)&&this.update(!e),this.enabled=e}},t.prototype.update=function(t){var e;return null==t&&(t=!1),this.initialized?(e=t?"":this.compiled.call(this.target),this.callback.call(null,e)):void 0},t.prototype.dispose=function(){var t,e,n,r;if(!this._disposed){for(this._disposed=!0,r=this.listeners,e=0,n=r.length;n>e;e++)t=r[e],t.dispose();return this.listeners.length=0,this.update(!0),this.initialized=!1,this.target=null,this.callback=null}},t}(),t.Binding=o,r=function(t){function e(t,e,n){this.binding=t,this.target=e,this.steps=this._build_list(n),this.enabled=this._disposed=!1,this.listeners=[],this._init=this.initialize.bind(this),this._disable=this.disable.bind(this),this._update=this.update.bind(this),this.initialize()}return h(e,t),e.types=[{name:"object",fun:function(t){return"object"==typeof t||"function"==typeof t}},{name:"simple",fun:function(t){return!("object"==typeof t)}}],e.prepend_type=function(t,e){return this.types.splice(0,0,{name:t,fun:e})},e.append_type=function(t,e){return this.types.push({name:t,fun:e})},e.prototype.initialize=function(){var t,e,n,r;if(!this._disposed){if(this.remove_listeners(),this.target._disposed)return this.dispose();for(t=0,n=this.target,this.failed=0,e=this.steps.length;t<this.steps.length&&(this.steps[t].fun.target=n,n=this.steps[t].fun.apply(n),this._check_target(n,null!=(r=this.steps[t+1])?r.name:void 0,0===t,t===e-1));)t++;return this.enabled=0===this.failed,this.binding.invalidate()}},e.prototype.dispose=function(){return this._disposed?void 0:(this.remove_listeners(),this._disposed=!0,this.enabled=!1,this.binding.invalidate(),this.binding=null,this.target=null)},e.prototype.disable=function(){return this.enabled?c.after(0,function(t){return function(){return t.initialize()}}(this)):void 0},e.prototype.update=function(){return this.enabled?(c.debug("update"),this.binding.invalidate()):void 0},e.prototype.remove_listeners=function(){var t,e,n,r;for(r=this.listeners,e=0,n=r.length;n>e;e++)t=r[e],t.dispose();return this.listeners.length=0},e.prototype._build_list=function(t){var e,n,r;for(n=0,r=t.length;r>n;n++)e=t[n],e.fun=s.compile_fun(this._to_chain(e));return t},e.prototype._to_chain=function(t){return{code:"chain",value:[t]}},e.prototype._check_target=function(t,e,n,r){var i,o;return r||null!=t?(i=this._detect_type(t),"function"==typeof this[o="handle_"+i]?this[o](t,e,n,r):void 0):this.dispose()},e.prototype._detect_type=function(t){var e,n,r,i;for(i=this.constructor.types,n=0,r=i.length;r>n;n++)if(e=i[n],e.fun.call(null,t))return e.name;return""},e.prototype.handle_object=function(t,e,n,r){return r||null!=t[e]?!0:void this.failed++},e.prototype.handle_simple=function(){return!0},e}(u),t.BindListener=r,i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.included=function(t){return t.extend(this)},e.prototype.bind=function(t,e){var n,r;return(n=this.__bindings__||(this.__bindings__={}))[r=""+t+"::"+e]||(n[r]=new o(this,t,e))},e.prototype.unbind=function(t,e){var n,r,i,o,s,u;if(null==t&&(t=""),null==e&&(e=""),null!=this.__bindings__){for(r=""+t,e&&(r+="::"+e),s=Object.keys(this.__bindings__),u=[],i=0,o=s.length;o>i;i++)n=s[i],0===n.indexOf(r)&&(this.__bindings__[n].dispose(),u.push(delete this.__bindings__[n]));return u}},e}(u),t.Bindable=i,n.exports=t}}),require.define({"pieces-core/core/config":function(t,e,n){"use strict";var r;r={},n.exports=r}}),require.define({"pieces-core/core/core":function(t,e,n){"use strict";var r,i,o=[].slice;i=e("./utils"),r=function(){function t(){var t,e,n,r,i;for(i=this.constructor.callbacked||[],e=function(t){return function(e){return t[e]=t["__"+e]}}(this),n=0,r=i.length;r>n;n++)t=i[n],e(t)}var e,n;return t.getset=function(t,e,n,r){var o,s;return null==r&&(r=!1),s=r?this:this.prototype,o={},null!=e&&(o.get=e),null!=n&&(o.set=n),Object.defineProperties(s,i.obj.wrap(t,o))},t.getter=function(t,e,n){return this.getset(t,e,null,n)},t.setter=function(t,e,n){return this.getset(t,null,e,n)},t.include=function(){var t,e,n,r,s;for(e=1<=arguments.length?o.call(arguments,0):[],s=[],n=0,r=e.length;r>n;n++)t=e[n],i.extend(this.prototype,t.prototype,!0,["constructor"]),s.push(t.included(this));return s},t.extend=function(){var t,e,n,r,s;for(e=1<=arguments.length?o.call(arguments,0):[],s=[],n=0,r=e.length;r>n;n++)t=e[n],i.extend(this,t,!0,["__super__"]),s.push(t.extended(this));return s},t.alias=function(t,e){this.prototype[t]=function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],this[e].apply(this,t)}},t.class_alias=function(t,e){this[t]=this[e]},t.included=i.truthy,t.extended=i.truthy,t.mixedin=i.truthy,t.register_callback=function(t,e){var n,r,s,u,a,c;for(null==e&&(e={}),n=e.as||t,r=e.only||["before","after"],r=i.to_a(r),s=function(t){return function(e){return t[""+e+"_"+n]=function(t){var r,i;return this.prototype["_"+e+"_"+n]&&!this.prototype.hasOwnProperty("_"+e+"_"+n)&&(this.prototype["_"+e+"_"+n]=this.prototype["_"+e+"_"+n].slice()),((r=this.prototype)[i="_"+e+"_"+n]||(r[i]=[])).push(t)}}}(this),u=0,a=r.length;a>u;u++)c=r[u],s(c);return this.prototype["__"+t]=function(){var e,r;return e=1<=arguments.length?o.call(arguments,0):[],this.run_callbacks("before_"+n,e),r=this.constructor.prototype[t].apply(this,e),this.run_callbacks("after_"+n,e),r},(this.callbacked||(this.callbacked=[])).push(t)},t.lookup_module=function(t){var e,n;for(t=i.camelCase(t),e=this;null!=e;){if(null!=e[t])return e[t];e=null!=(n=e.__super__)?n.constructor:void 0}return i.debug("module not found: "+t),null},t.prototype.mixin=function(){var t,e,n,r,s;for(e=1<=arguments.length?o.call(arguments,0):[],s=[],n=0,r=e.length;r>n;n++)t=e[n],"string"==typeof t&&(t=this.constructor.lookup_module(t)),t&&(i.extend(this,t.prototype,!0,["constructor"]),s.push(t.mixedin(this)));return s},n=function(t){return null!=this["__h__"+t]?this["__h__"+t]:void 0},e=function(t,e){return this["__h__"+t]=e},t.event_handler=function(t,r){return null==r&&(r={}),"function"!=typeof this.prototype[t]?i.error("undefined handler",this,t):(this.prototype[t]=i.func.unwrap(this.prototype[t],r),this.prototype[t]=i.func.wrap(this.prototype[t],i.curry(n,t),i.curry(e,t),{break_if_value:!0}))},t.prototype.run_callbacks=function(t,e){var n,r,i,o,s;for(o=this["_"+t]||[],s=[],r=0,i=o.length;i>r;r++)n=o[r],s.push(n.apply(this,e));return s},t.prototype.delegate_to=function(){var t,e,n,r,i,s;for(n=arguments[0],e=2<=arguments.length?o.call(arguments,1):[],n="string"==typeof n?this[n]:n,r=function(t){return function(e){return t[e]=function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],n[e].apply(n,t)}}}(this),i=0,s=e.length;s>i;i++)t=e[i],r(t)},t}(),n.exports=r}}),require.define({"pieces-core/core/events/aliases":function(t,e,n){"use strict";var r,i;i=e("../nod").NodEvent,r=e("../utils/browser"),r.info().gecko&&i.register_alias("mousewheel","DOMMouseScroll")}}),require.define({"pieces-core/core/events/events":function(t,e,n){"use strict";var r,i,o,s,t,u,a,c={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=e("../utils"),r=e("../core"),t={},i=function(t){function e(t,e,n){this.target=e,null==n&&(n=!0),null!=t&&"object"==typeof t?u.extend(this,t):this.type=t,this.bubbles=n,this.canceled=!1,this.captured=!1}return l(e,t),e.prototype.cancel=function(){return this.canceled=!0},e}(r),t.Event=i,s=function(t){function e(t,n,r,i,o){this.type=t,this.handler=n,this.context=null!=r?r:null,this.disposable=null!=i?i:!1,this.conditions=o,e.__super__.constructor.apply(this,arguments),null==this.handler._uid&&(this.handler._uid="fun"+u.uid()),this.uid=""+this.type+":"+this.handler._uid,"function"!=typeof this.conditions&&(this.conditions=u.truthy),null!=this.context&&(null==this.context._uid&&(this.context._uid="obj"+u.uid()),this.uid+=":"+this.context._uid)}return l(e,t),e.prototype.dispatch=function(t){return!this.disposed&&this.conditions(t)?(this.handler.call(this.context,t)!==!1&&(t.captured=!0),this.disposable?this.dispose():void 0):void 0},e.prototype.dispose=function(){return this.handler=this.context=this.conditions=null,this.disposed=!0},e}(r),a=function(t){return"string"==typeof t?t.split(/\,\s*/):Array.isArray(t)?t:[null]},t.EventListener=s,o=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.listeners={},this.listeners_by_key={}}return l(e,t),e.prototype.listeners="",e.prototype.listeners_by_key="",e.prototype.on=function(t,e,n,r){var i,o,u,c,l;for(c=a(t),l=[],o=0,u=c.length;u>o;o++)i=c[o],l.push(this.add_listener(new s(i,e,n,!1,r)));return l},e.prototype.one=function(t,e,n,r){return this.add_listener(new s(t,e,n,!0,r))},e.prototype.off=function(t,e,n,r){var i,o,s,u,c;for(u=a(t),c=[],o=0,s=u.length;s>o;o++)i=u[o],c.push(this.remove_listener(i,e,n,r));return c},e.prototype.trigger=function(t,e,n){var r,o,s,a;if(null==n&&(n=!0),t instanceof i||(t=new i(t,this,n)),null!=e&&(t.data=e),t.currentTarget=this,null!=this.listeners[t.type]){for(u.debug_verbose("Event: "+t.type,t),a=this.listeners[t.type],o=0,s=a.length;s>o&&(r=a[o],r.dispatch(t),t.canceled!==!0);o++);this.remove_disposed_listeners()}t.captured!==!0&&t.bubbles&&this.bubble_event(t)},e.prototype.bubble_event=function(t){},e.prototype.add_listener=function(t){var e,n;return(e=this.listeners)[n=t.type]||(e[n]=[]),this.listeners[t.type].push(t),this.listeners_by_key[t.uid]=t},e.prototype.remove_listener=function(t,e,n,r){var i,o,s,u,a;if(null==n&&(n=null),null==r&&(r=null),null==t)return this.remove_all();if(null!=this.listeners[t]){if(null==e){for(a=this.listeners[t],s=0,u=a.length;u>s;s++)i=a[s],i.dispose();return this.remove_type(t),void this.remove_disposed_listeners()}o=""+t+":"+e._uid,null!=n&&(o+=":"+n._uid),i=this.listeners_by_key[o],null!=i&&(delete this.listeners_by_key[o],this.remove_listener_from_list(t,i))}},e.prototype.remove_listener_from_list=function(t,e){return null!=this.listeners[t]&&this.listeners[t].indexOf(e)>-1&&(this.listeners[t]=this.listeners[t].filter(function(t){return t!==e}),!this.listeners[t].length)?this.remove_type(t):void 0},e.prototype.remove_disposed_listeners=function(){var t,e,n,r;n=this.listeners_by_key,r=[];for(t in n)e=n[t],e.disposed?(this.remove_listener_from_list(e.type,e),r.push(delete this.listeners_by_key[t])):r.push(void 0);return r},e.prototype.remove_type=function(t){return delete this.listeners[t]},e.prototype.remove_all=function(){return this.listeners={},this.listeners_by_key={}},e}(r),t.EventDispatcher=o,n.exports=t}}),require.define({"pieces-core/core/events/index":function(t,e,n){"use strict";n.exports=e("./events")}}),require.define({"pieces-core/core/events/resize_delegate":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=e("../utils"),i=e("./events").EventListener,r=e("../core"),o=e("../nod").Nod,s=e("../nod").NodEvent,a=function(t){function e(t,n){var r;this.nod=t,this.handler=n,this._w=this.nod.width(),this._h=this.nod.height(),r=function(t){return function(e){return t._w!==e.width||t._h!==e.height?(t._w=e.width,t._h=e.height,!0):!1}}(this),e.__super__.constructor.call(this,"resize",this.handler,this.nod,!1,r)}return h(e,t),e}(i),u=function(t){function e(){this.listeners=[]}return h(e,t),e.prototype.add=function(t,e){return this.listeners.push(new a(t,e)),1===this.listeners.length?this.listen():void 0},e.prototype.remove=function(t){var e,n,r,i,o,s;for(e=!1,s=this.listeners,n=i=0,o=s.length;o>i;n=++i)if(r=s[n],r.nod===t){e=!0;break}return e===!0?this.listeners.splice(n,1):void 0},e.prototype.listen=function(){return s.add(o.win.node,"resize",this.resize_listener())},e.prototype.off=function(){return s.remove(o.win.node,"resize",this.resize_listener())},e.prototype.resize_listener=function(t){var e,n,r,i,o;for(i=this.listeners,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(e.dispatch(this._create_event(e)));return o},e.event_handler("resize_listener",{throttle:300}),e.prototype._create_event=function(t){var e;return e=t.nod,{type:"resize",target:e,width:e.width(),height:e.height()}},e}(r),n.exports=u}}),require.define({"pieces-core/core/former/former":function(t,e,n){"use strict";var r,i,o=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};i=e("../utils"),r=function(){function t(t,e){this.nod=t,this.options=null!=e?e:{},this.options.rails===!0&&(this.options.name_transform=this._rails_name_transform),this.options.serialize===!0&&(this.options.parse_value=i.serialize)}return t.parse=function(e,n){return new t(e,n).parse()},t.fill=function(e,n){return new t(e,n).fill()},t.clear=function(e,n){return new t(e,n).clear()},t.prototype.parse=function(){return this.process_name_values(this.collect_name_values())},t.prototype.fill=function(t){return this.traverse_nodes(this.nod,function(e){return function(n){return e._fill_nod(n,t)}}(this))},t.prototype.clear=function(){return this.traverse_nodes(this.nod,function(t){return function(e){return t._clear_nod(e)}}(this))},t.prototype.process_name_values=function(t){var e,n,r,i,s,u;for(u={},n={},r=function(t){return function(e){var r,i,s,a,c,l,h,p,_,f,d;if(s=e.name,c=e.value,!t.options.skip_empty||""!==c&&null!==c){for(l="",h=u,s=t.transform_name(s,!1),c=t.transform_value(c),f=s.split("."),i=f.length,d=[],r=p=0,_=f.length;_>p;r=++p)a=f[r],d.push(function(t){var e,s,u,a;return t.indexOf("[]")>-1?(s=t.substr(0,t.indexOf("[")),l+=s,h[s]||(h[s]=[]),r===i-1?h[s].push(c):(a=f[r+1],n[l]||(n[l]=[]),e=n[l].length,h[s].length>0&&(u=h[s][h[s].length-1]),(!e||o.call(n[l],a)>=0&&!(a.indexOf("[]")>-1||null==u[a]||r+1!==i-1))&&(u={},h[s].push(u),n[l]=[]),n[l].push(a),h=u)):(l+=t,i-1>r?(h[t]||(h[t]={}),h=h[t]):h[t]=c)}(a));return d}}}(this),i=0,s=t.length;s>i;i++)e=t[i],r(e);return u},t.prototype.collect_name_values=function(){return this.traverse_nodes(this.nod,function(t){return function(e){return t._parse_nod(e)}}(this))},t.prototype.traverse_nodes=function(t,e){var n,r;for(r=this._to_array(e(t)),n=t.firstChild;null!=n;)1===n.nodeType&&(r=r.concat(this.traverse_nodes(n,e))),n=n.nextSibling;return r},t.prototype.transform_name=function(t,e){return null==e&&(e=!0),this.options.fill_prefix&&e&&(t=t.replace(this.options.fill_prefix,"")),null!=this.options.name_transform&&(t=this.options.name_transform(t)),t},t.prototype.transform_value=function(t){return null!=this.options.parse_value?this.options.parse_value(t):t},t.prototype._to_array=function(t){return null==t?[]:i.to_a(t)},t.prototype._parse_nod=function(t){var e;if((this.options.disabled!==!1||!t.disabled)&&/(input|select|textarea)/i.test(t.nodeName)&&t.name&&(e=this._parse_nod_value(t),null!=e))return{name:t.name,value:e}},t.prototype._fill_nod=function(t,e){var n,r;if(/(input|select|textarea)/i.test(t.nodeName)&&(r=this._nod_data_value(t.name,e),null!=r))if("select"===t.nodeName.toLowerCase())this._fill_select(t,r);else{if("object"==typeof r)return;switch(n=t.type.toLowerCase(),!1){case!(/(radio|checkbox)/.test(n)&&r):t.checked=!0;break;case!(/(radio|checkbox)/.test(n)&&!r):t.checked=!1;break;default:t.value=r}}},t.prototype._fill_select=function(t,e){var n,r,i,s,u;for(e=e instanceof Array?e:[e],e=e.map(function(t){return""+t}),s=t.getElementsByTagName("option"),u=[],r=0,i=s.length;i>r;r++)n=s[r],u.push(function(t){var n;return t.selected=(n=t.value,o.call(e,n)>=0)}(n));return u},t.prototype._clear_nod=function(t){var e;if(/(input|select|textarea)/i.test(t.nodeName))if("select"===t.nodeName.toLowerCase())this._fill_select(t,[]);else switch(e=t.type.toLowerCase(),!1){case!/(radio|checkbox)/.test(e):t.checked=!1;break;case!("hidden"===e&&!this.options.clear_hidden):break;default:t.value=""}},t.prototype._nod_data_value=function(t,e){var n,r,i,o;if(t&&(t=this.transform_name(t),!(t.indexOf("[]")>-1))){for(o=t.split("."),r=0,i=o.length;i>r&&(n=o[r],e=e[n],null!=e);r++);return e}},t.prototype._parse_nod_value=function(t){var e;if("select"===t.nodeName.toLowerCase())return this._parse_select_value(t);switch(e=t.type.toLowerCase(),!1){case!(/(radio|checkbox)/.test(e)&&t.checked):return t.value;case!(/(radio|checkbox)/.test(e)&&!t.checked):return null;case!/(button|reset|submit|image)/.test(e):return null;case!/(file)/.test(e):return this._parse_file_value(t);default:return t.value}},t.prototype._parse_file_value=function(t){var e;if(null!=(e=t.files)?e.length:void 0)return t.multiple?t.files:t.files[0]},t.prototype._parse_select_value=function(t){var e,n,r,i,o,s;if(e=t.multiple,!e)return t.value;for(o=t.getElementsByTagName("option"),s=[],r=0,i=o.length;i>r;r++)n=o[r],n.selected&&s.push(n.value);return s},t.prototype._rails_name_transform=function(t){return t.replace(/\[([^\]])/gi,".$1").replace(/([^\[])([\]]+)/gi,"$1")},t}(),n.exports=r}}),require.define({"pieces-core/core/index":function(t,e,n){"use strict";var r={},i={};r["export"]=function(t,e){window[e]&&!i[e]&&(i[e]=window[e]),window[e]=t},r.noconflict=function(){for(var t in i)i.hasOwnProperty(t)&&(window[t]=i[t])},r.config=e("./config");var o=r.utils=e("./utils");r["export"](o.curry,"curry"),r["export"](o.delayed,"delayed"),r["export"](o.after,"after"),r["export"](o.debounce,"debounce"),r["export"](o.throttle,"throttle"),r.Core=e("./core"),r.Events=e("./events");var s=e("./nod");r.Nod=s.Nod,o.extend(r.Events,s,!1,["Nod"]),r.Events.ResizeDelegate=e("./events/resize_delegate"),r.Events.NodEvent.register_delegate("resize",new r.Events.ResizeDelegate),e("./events/aliases"),r.bindings=e("./binding"),n.exports=r}}),require.define({"pieces-core/core/nod":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,t,h,p,_,f,d,y,v,g,m,b,w,x,k,E,O,z,q,j,C,P,S,N,A,L,$,T,D,I,R,M,B,F,H={}.hasOwnProperty,U=function(t,e){function n(){this.constructor=t}for(var r in e)H.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},X=[].slice;for(p=e("./utils"),i=e("./events").EventDispatcher,r=e("./events").Event,t={},a=function(t){function e(t){this.event=t||window.event,this.origTarget=this.event.target||this.event.srcElement,this.target=u.create(this.origTarget),this.type=this.constructor.is_aliased(t.type)?this.constructor.reversed_aliases[t.type]:t.type,this.ctrlKey=this.event.ctrlKey,this.shiftKey=this.event.shiftKey,this.altKey=this.event.altKey,this.metaKey=this.event.metaKey,this.detail=this.event.detail,this.bubbles=this.event.bubbles}return U(e,t),e.aliases={},e.reversed_aliases={},e.delegates={},e.add=function(t,e,n){return t.addEventListener(e,n)},e.remove=function(t,e,n){return t.removeEventListener(e,n)},e.register_delegate=function(t,e){return this.delegates[t]=e},e.has_delegate=function(t){return!!this.delegates[t]},e.register_alias=function(t,e){return this.aliases[t]=e,this.reversed_aliases[e]=t},e.has_alias=function(t){return!!this.aliases[t]},e.is_aliased=function(t){return!!this.reversed_aliases[t]},e.prototype.stopPropagation=function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0},e.prototype.stopImmediatePropagation=function(){return this.event.stopImmediatePropagation?this.event.stopImmediatePropagation():(this.event.cancelBubble=!0,this.event.cancel=!0)},e.prototype.preventDefault=function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1},e.prototype.cancel=function(){return this.stopImmediatePropagation(),this.preventDefault(),e.__super__.cancel.apply(this,arguments)},e}(r),t.NodEvent=a,P=/(click|mouse|contextmenu)/i,z=/(keyup|keydown|keypress)/i,s=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.button=this.event.button,null==this.pageX&&(this.pageX=this.event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.pageY=this.event.clientY+document.body.scrollTop+document.documentElement.scrollTop),null==this.offsetX&&(this.offsetX=this.event.layerX-this.origTarget.offsetLeft,this.offsetY=this.event.layerY-this.origTarget.offsetTop),this.wheelDelta=this.event.wheelDelta,null==this.wheelDelta&&(this.wheelDelta=40*-this.event.detail)}return U(e,t),e}(a),t.MouseEvent=s,o=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.keyCode=this.event.keyCode||this.event.which,this.charCode=this.event.charCode}return U(e,t),e}(a),t.KeyEvent=o,N=function(t){return P.test(t.type)?new s(t):z.test(t.type)?new o(t):new a(t)},R=/^[\.#]/,I=function(t,e){return R.test(t)?function(n){var r;if(e||(e=document),r=n.target.node,r.matches(t))return!0;if(r===e)return!1;for(;(r=r.parentNode)&&r!==e;)if(r.matches(t))return n.target=u.create(r)}:function(e){return e.target.node.matches(t)}},c=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.native_event_listener=function(t){return function(e){return t.trigger(N(e))}}(this)}return U(e,t),e.prototype.listen=function(t,e,n,r){return this.on(e,n,r,I(t,this.node))},e.prototype.add_native_listener=function(t){return a.has_delegate(t)?a.delegates[t].add(this,this.native_event_listener):a.add(this.node,t,this.native_event_listener)},e.prototype.remove_native_listener=function(t){return a.has_delegate(t)?a.delegates[t].remove(this):a.remove(this.node,t,this.native_event_listener)},e.prototype.add_listener=function(t){return this.listeners[t.type]||this.add_native_listener(a.has_alias(t.type)?a.aliases[t.type]:t.type),e.__super__.add_listener.apply(this,arguments)},e.prototype.remove_type=function(t){return this.remove_native_listener(a.has_alias(t)?a.aliases[t]:t),e.__super__.remove_type.apply(this,arguments)},e.prototype.remove_all=function(){var t,n,r,i;i=this.listeners,r=function(t){return function(){return t.remove_native_listener(a.has_alias(n)?a.aliases[n]:n)}}(this);for(n in i)H.call(i,n)&&(t=i[n],r());return e.__super__.remove_all.apply(this,arguments)},e}(i),t.NodEventDispatcher=c,A=function(t,e){return u.prototype[t]=function(t,n){var r,i;if("object"!=typeof t)return e.call(this,t,n);for(r in t)H.call(t,r)&&(i=t[r],e.call(this,r,i))}},x=function(t){var e,n,r,i;for(n=function(){var t;t=e,u.prototype[t]=function(e){return void 0===e?this.node["offset"+p.capitalize(t)]:(this._with_raf(t,function(n){return function(){return n.node.style[t]=e+"px","width"===t||"height"===t?n.trigger("resize"):void 0}}(this)),this)}},r=0,i=t.length;i>r;r++)e=t[r],n()},M=function(t){var e;return Array.isArray(t)?(e=t[0],t=t[1]):e=t,u.prototype[e]=function(e){return null!=e?(this.node[t]=e,this):this.node[t]}},b=function(t){var e,n;for(n=document.createElement("div"),n.innerHTML=t,e=document.createDocumentFragment();n.firstChild;)e.appendChild(n.firstChild);return e},S=function(t){return t instanceof u?t.node:"string"==typeof t?b(t):t},d=/^data-\w[\w\-]*$/,w=function(t){var e;return e=t.split("-"),e.join("_")},y=function(){return"undefined"==typeof DOMStringMap?function(t){var e,n,r,i,o;if(n={},null!=t.attributes)for(o=t.attributes,r=0,i=o.length;i>r;r++)e=o[r],d.test(e.name)&&(n[w(e.name.slice(5))]=p.serialize(e.value));return n}:function(t){var e,n,r,i;e={},i=t.dataset;for(n in i)H.call(i,n)&&(r=i[n],e[p.snake_case(n)]=p.serialize(r));return e}}(),L=null!=window.requestAnimationFrame?window.requestAnimationFrame:function(t){return p.after(0,t)},f=null!=window.cancelAnimationFrame?window.cancelAnimationFrame:p.pass,B={},u=function(t){function e(t){if(this.node=t,e.__super__.constructor.apply(this,arguments),null==this.node)throw Error("Node is undefined!");this._disposed=!1,this._data=y(this.node),e.store(this)}return U(e,t),e.store=function(t,e){var n;return null==e&&(e=!1),n=t.node,n._nod&&B[n._nod]&&!e?void 0:(n._nod=p.uid("nod"),B[n._nod]=t)},e.fetch=function(t){return t&&B[t]},e["delete"]=function(t){var e;return delete B[null!=(e=t.node)?e._nod:void 0]},e.create=function(t){switch(!1){case!!t:return null;case!(t instanceof this):return t;case!("undefined"!=typeof t._nod):return e.fetch(t._nod);case!p.is_html(t):return this._create_html(t);case"string"!=typeof t:return new this(document.createElement(t));default:return new this(t)}},e._create_html=function(t){var e,n;return n=b(t),e=n.firstChild,n.removeChild(e),new this(e)},e.prototype.find=function(t){return e.create(this.node.querySelector(t))},e.prototype.all=function(t){return this.node.querySelectorAll(t)},e.prototype.each=function(t,e){var n,r,i,o,s,u;for(n=0,s=this.node.querySelectorAll(t),u=[],i=0,o=s.length;o>i&&(r=s[i],e.call(null,r,n)!==!0);i++)u.push(n++);return u},e.prototype.first=function(t){return this.find(t)},e.prototype.last=function(t){return this.find(""+t+":last-child")},e.prototype.nth=function(t,e){return this.find(""+t+":nth-child("+e+")")},e.prototype.find_bf=function(t){var e,n,r,i;for(i=[],e=[],n=this.node.firstChild;n;)if(1===n.nodeType){if(n.matches(t))e.push(n),r=n.querySelector(t),null!=r&&i.push(r);else if(r=n.querySelector(t)){n.nextSibling&&i.unshift(n.nextSibling),n=r;continue}n=n.nextSibling||i.shift()}else n=n.nextSibling||i.shift();return e},e.prototype.find_cut=function(t){var e,n,r;for(r=[],e=[],n=this.node.firstChild;n;)1===n.nodeType?(n.matches(t)?e.push(n):n.firstChild&&r.unshift(n.firstChild),n=n.nextSibling||r.shift()):n=n.nextSibling||r.shift();return e},e.prototype.attrs=function(t){var e,n;for(e in t)H.call(t,e)&&(n=t[e],this.attr(e,n));return this},e.prototype.styles=function(t){var e,n;for(e in t)H.call(t,e)&&(n=t[e],this.style(e,n));return this},e.prototype.parent=function(t){var n;if(null==t)return null!=this.node.parentNode?e.create(this.node.parentNode):null;for(n=this.node;(n=n.parentNode)&&n!==document;)if(n.matches(t))return e.create(n);return null},e.prototype.children=function(t){var e,n,r,i,o;if(null!=t){for(i=this.node.children,o=[],n=0,r=i.length;r>n;n++)e=i[n],e.matches(t)&&o.push(e);return o}return this.node.children},e.prototype.wrap=function(){var t,n;return t=1<=arguments.length?X.call(arguments,0):[],n=e.create("div"),n.addClass.apply(n,t),this.node.parentNode.insertBefore(n.node,this.node),n.append(this.node)},e.prototype.prepend=function(t){return t=S(t),this.node.insertBefore(t,this.node.firstChild),this},e.prototype.append=function(t){return t=S(t),this.node.appendChild(t),this},e.prototype.insertBefore=function(t){return t=S(t),this.node.parentNode.insertBefore(t,this.node),this},e.prototype.insertAfter=function(t){return t=S(t),this.node.parentNode.insertBefore(t,this.node.nextSibling),this},e.prototype.detach=function(){var t;return null!=(t=this.node.parentNode)&&t.removeChild(this.node),this},e.prototype.detach_children=function(){for(;this.node.children.length;)this.node.removeChild(this.node.children[0]);return this},e.prototype.remove_children=function(){for(var t;this.node.firstChild;)(t=e.fetch(this.node.firstChild._nod))?t.remove():this.node.removeChild(this.node.firstChild);return this},e.alias("empty","remove_children"),e.prototype.remove=function(){return this.detach(),this.remove_children(),this.dispose(),null},e.prototype.clone=function(){var t,n;return t=document.createElement(this.node.nameNode),t.innerHTML=this.node.outerHTML,n=new e(t.firstChild),p.extend(n,this,!0,["listeners","listeners_by_type","__components__","native_event_listener","node"])},e.prototype.dispose=function(){this._disposed||(this.off(),e["delete"](this),this._disposed=!0)},e.prototype.name=function(){return this.node.name||this.data("name")},e.prototype.addClass=function(){var t,e,n;for(e=0,n=arguments.length;n>e;e++)t=arguments[e],this.node.classList.add(t);return this},e.prototype.removeClass=function(){var t,e,n;for(e=0,n=arguments.length;n>e;e++)t=arguments[e],this.node.classList.remove(t);return this},e.prototype.toggleClass=function(t){return this.node.classList.toggle(t),this},e.prototype.hasClass=function(t){return this.node.classList.contains(t)},e.prototype.mergeClasses=function(t){var e,n,r,i;for(i=t.node.className.split(/\s+/),n=0,r=i.length;r>n;n++)e=i[n],e&&this.addClass(e);return this},e.prototype.x=function(){var t,e;for(e=this.node.offsetLeft,t=this.node;t=t.offsetParent;)e+=t.offsetLeft;return e},e.prototype.y=function(){var t,e;for(e=this.node.offsetTop,t=this.node;t=t.offsetParent;)e+=t.offsetTop;return e},e.prototype._with_raf=function(t,e){return this["__"+t+"_rid"]&&(f(this["__"+t+"_rid"]),delete this["__"+t+"_rid"]),this["__"+t+"_rid"]=L(e)},e.prototype.move=function(t,e){return this._with_raf("move",function(n){return function(){return n.style({left:""+t+"px",top:""+e+"px"})}}(this))},e.prototype.moveX=function(t){return this.left(t)},e.prototype.moveY=function(t){return this.top(t)},e.prototype.scrollX=function(t){return this._with_raf("scrollX",function(e){return function(){return e.node.scrollLeft=t}}(this))},e.prototype.scrollY=function(t){return this._with_raf("scrollY",function(e){return function(){return e.node.scrollTop=t}}(this))},e.prototype.position=function(){return{x:this.x(),y:this.y()}},e.prototype.offset=function(){return{x:this.node.offsetLeft,y:this.node.offsetTop}},e.prototype.size=function(t,e){return null==t&&(t=null),null==e&&(e=null),null==t||null==e?{width:this.width(),height:this.height()}:(null==t&&(t=this.width()),null==e&&(e=this.height()),void this._with_raf("size",function(n){return function(){return n.node.style.width=t+"px",n.node.style.height=e+"px",n.trigger("resize")}}(this)))},e.prototype.show=function(){return this.node.style.display="block"},e.prototype.hide=function(){return this.node.style.display="none"},e.prototype.focus=function(){return this.node.focus(),this},e.prototype.blur=function(){return this.node.blur(),this},e}(c),A("data",function(t,e){return void 0===t?this._data:(t=t.replace("-","_"),null===e?(e=this._data[t],delete this._data[t],e):void 0===e?this._data[t]:(this._data[t]=e,this))}),A("style",function(t,e){if(null===e)this.node.style[t]=null;else if(void 0===e)return this.node.style[t];return this.node.style[t]=e}),A("attr",function(t,e){return null===e?this.node.removeAttribute(t):void 0===e?this.node.getAttribute(t):this.node.setAttribute(t,e)}),x(["top","left","width","height"]),$=[["html","innerHTML"],"outerHTML",["text","textContent"],"value"],v=function(){return M(h)},k=0,q=$.length;q>k;k++)h=$[k],v();for(T=["width","height"],g=function(){return h="client"+p.capitalize(l),u.prototype[h]=function(){return this.node[h]}},E=0,j=T.length;j>E;E++)l=T[E],g();for(D=["top","left","width","height"],m=function(){return h="scroll"+p.capitalize(l),u.prototype[h]=function(){return this.node[h]}},O=0,C=D.length;C>O;O++)l=D[O],m();t.Nod=u,u.Root=function(t){function e(){if(u.Root.instance)throw"Nod.Root is already defined!";u.Root.instance=this,e.__super__.constructor.call(this,document.documentElement)}return U(e,t),e.instance=null,e.prototype.initialize=function(){var t,e,n;if(n=document.attachEvent?"complete":"interactive",this._loaded="complete"===document.readyState,this._loaded||(this._loaded_callbacks=[],t=function(e){return function(){return p.debug("DOM loaded"),e._loaded=!0,e.fire_all(),a.remove(window,"load",t)}}(this),a.add(window,"load",t)),!this._ready){if(document.addEventListener){if(this._ready=document.readyState===n,
this._ready)return;return this._ready_callbacks=[],e=function(t){return function(){return p.debug("DOM ready"),t._ready=!0,t.fire_ready(),document.removeEventListener("DOMContentLoaded",e)}}(this),document.addEventListener("DOMContentLoaded",e)}if(this._ready=document.readyState===n,this._ready)return;return this._ready_callbacks=[],e=function(t){return function(){return document.readyState===n?(p.debug("DOM ready"),t._ready=!0,t.fire_ready(),document.detachEvent("onreadystatechange",e)):void 0}}(this),document.attachEvent("onreadystatechange",e)}},e.prototype.ready=function(t){return this._ready?t.call(null):this._ready_callbacks.push(t)},e.prototype.loaded=function(t){return this._loaded?t.call(null):this._loaded_callbacks.push(t)},e.prototype.fire_all=function(){var t;for(this._ready_callbacks&&this.fire_ready();t=this._loaded_callbacks.shift();)t.call(null);return this._loaded_callbacks=null},e.prototype.fire_ready=function(){for(var t;t=this._ready_callbacks.shift();)t.call(null);return this._ready_callbacks=null},e.prototype.scrollTop=function(){return this.node.scrollTop||document.body.scrollTop},e.prototype.scrollLeft=function(){return this.node.scrollLeft||document.body.scrollLeft},e.prototype.scrollHeight=function(){return this.node.scrollHeight},e.prototype.scrollWidth=function(){return this.node.scrollWidth},e.prototype.height=function(){return window.innerHeight||this.node.clientHeight},e.prototype.width=function(){return window.innerWidth||this.node.clientWidth},e}(u),u.Win=function(t){function e(){if(u.Win.instance)throw"Nod.Win is already defined!";u.Win.instance=this,this.delegate_to(u.root,"scrollLeft","scrollTop","scrollWidth","scrollHeight"),e.__super__.constructor.call(this,window)}return U(e,t),e.instance=null,e.prototype.scrollY=function(t){var e;return e=this.scrollLeft(),this._with_raf("scrollY",function(n){return function(){return n.node.scrollTo(e,t)}}(this))},e.prototype.scrollX=function(t){var e;return e=this.scrollTop(),this._with_raf("scrollX",function(n){return function(){return n.node.scrollTo(t,e)}}(this))},e.prototype.width=function(){return this.node.innerWidth},e.prototype.height=function(){return this.node.innerHeight},e.prototype.x=function(){return 0},e.prototype.y=function(){return 0},e}(u),F=null,_=null,Object.defineProperties(u,{win:{get:function(){return F||(F=new u.Win)}},body:{get:function(){return _||(_=new u(document.body))}}}),n.exports=t}}),require.define({"pieces-core/core/utils/arr":function(t,e,n){"use strict";var r,i,o=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};i=e("./base"),r=function(){function t(){}return t.sort=function(t,e){return t.sort(i.curry(i.keys_compare,[e],i,!0))},t.sort_by=function(t,e,n){return null==n&&(n="asc"),t.sort(i.curry(i.key_compare,[e,n],i,!0))},t.uniq=function(t){var e,n,r,i;for(n=[],r=0,i=t.length;i>r;r++)e=t[r],o.call(n,e)<0&&n.push(e);return n},t.shuffle=function(t){var e,n,r,o,s,u,a;for(r=t.length,o=Array(r),e=u=0,a=t.length;a>u;e=++u)s=t[e],n=i.random(0,e),e!==n&&(o[e]=o[n]),o[n]=t[e];return o},t.sample=function(t,e){var n;return null==e&&(e=1),n=t.length,1===e?t[i.random(n-1)]:this.shuffle(t).slice(0,+(e-1)+1||9e9)},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/base":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l={}.hasOwnProperty,h=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},p=[].slice;for(c=100,i=function(){function t(){}return t.email_rxp=/\b[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}\b/i,t.digital_rxp=/^[\d\s-\(\)]+$/,t.html_rxp=/^\s*<[\s\S]+>\s*$/m,t.esc_rxp=/[-[\]{}()*+?.,\\^$|#]/g,t.clickable_rxp=/^(a|button|input|textarea)$/i,t.input_rxp=/^(input|select|textarea)$/i,t.notsnake_rxp=/((?:^[^A-Z]|[A-Z])[^A-Z]*)/g,t.str_rxp=/(^'|'$)/g,t.html_entities={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},t.html_entities_rxp=/[&<>"']/g,t.uid=function(t){return(t||"")+ ++c},t.random=function(t,e){var n;return null==e&&(e=null),null==e&&(n=[t,0],e=n[0],t=n[1]),t+Math.random()*(e-t+1)|0},t.escapeRegexp=function(t){return t.replace(this.esc_rxp,"\\$&")},t.escapeHTML=function(t){return t?(""+t).replace(this.html_entities_rxp,function(t){return function(e){return t.html_entities[e]}}(this)):t},t.is_digital=function(t){return this.digital_rxp.test(t)},t.is_email=function(t){return this.email_rxp.test(t)},t.is_html=function(t){return this.html_rxp.test(t)},t.is_clickable=function(t){return this.clickable_rxp.test(t.nodeName)},t.is_input=function(t){return this.input_rxp.test(t.nodeName)},t.camelCase=function(t){var e;return t+="",t.length?function(){var n,r,i,o;for(i=t.split("_"),o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.capitalize(e));return o}.call(this).join(""):t},t.snake_case=function(t){var e,n;return t+="",t.length?(e=t.match(this.notsnake_rxp),function(){var t,r,i;for(i=[],t=0,r=e.length;r>t;t++)n=e[t],i.push(n.toLowerCase());return i}().join("_")):t},t.capitalize=function(t){return t[0].toUpperCase()+t.slice(1)},t.serialize=function(t){return t=function(){switch(!1){case!(null==t):return null;case"null"!==t:return null;case"undefined"!==t:return void 0;case"true"!==t:return!0;case"false"!==t:return!1;case""!==t:return"";case!(isNaN(Number(t))&&"string"==typeof t):return(t+"").replace(this.str_rxp,"");case!isNaN(Number(t)):return t;default:return Number(t)}}.call(this)},t.squish=function(t){return(""+t).replace(/(^\s+|\s+$)/g,"").replace(/\s+/g," ")},t.key_compare=function(t,e,n,r){var i;return i="asc"===r,t=this.serialize(t[n]),e=this.serialize(e[n]),t===e?0:!t||e>t?1+-2*i:-(1+-2*i)},t.keys_compare=function(t,e,n){var r,i,o,s,u,a,c;for(s=0,a=0,c=n.length;c>a;a++){o=n[a],u=function(n){return function(r,i){var o;return o=n.key_compare(t,e,r,i),0===s?s=o:void 0}}(this);for(r in o)l.call(o,r)&&(i=o[r],u(r,i))}return s},t.clone=function(t,e){var n,r,i;if(null==e&&(e=[]),null==t||"object"!=typeof t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return n="",null!=t.global&&(n+="g"),null!=t.ignoreCase&&(n+="i"),null!=t.multiline&&(n+="m"),null!=t.sticky&&(n+="y"),new RegExp(t.source,n);if(t instanceof Element)return t.cloneNode(!0);if("function"==typeof t.clone)return t.clone();i=new t.constructor;for(r in t)h.call(e,r)<0&&(i[r]=this.clone(t[r]));return i},t.merge=function(t,e){var n,r,i;r=this.clone(t);for(n in e)l.call(e,n)&&(i=e[n],r[n]=i);return r},t.extend=function(t,e,n,r){var i,o;null==n&&(n=!1),null==r&&(r=[]);for(i in e)l.call(e,i)&&(o=e[i],null!=t[i]&&!n||h.call(r,i)>=0||(t[i]=o));return t},t.extract_to=function(t,e,n){var r,i,o,s,u,a,c,h,p;if(null!=e){if(Array.isArray(e))for(u=function(e){return function(r){var i;return i={},e.extract_to(i,r,n),t.push(i)}}(this),a=0,h=e.length;h>a;a++)r=e[a],u(r);else if("string"==typeof n)null!=e[n]&&(t[n]=e[n]);else if(Array.isArray(n))for(c=0,p=n.length;p>c;c++)o=n[c],this.extract_to(t,e,o);else for(i in n)if(l.call(n,i)){if(s=n[i],null==e[i])return;t[i]=Array.isArray(e[i])?[]:{},this.extract_to(t[i],e[i],s)}return t}},t.extract=function(t,e){var n;return n={},this.extract_to(n,t,e),n},t.subclass=function(t){var e,n;e=function(){return this.constructor.__super__.constructor.apply(this,arguments)};for(n in t)l.call(t,n)&&(e[n]=t[n]);return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__super__=t.prototype,e},t.to_a=function(t){return null==t?[]:Array.isArray(t)?t:[t]},t.debounce=function(e,n,r,i){var o,s;return null==i&&(i=!1),s=!1,o=null,function(){var u;return u=1<=arguments.length?p.call(arguments,0):[],s?void(o=u):((r||{}).__debounce_id__=t.after(e,function(){return s=!1,i&&null!=o&&n.apply(r,o),o=null}),s=!0,null==o?n.apply(r,u):void 0)}},t.throttle=function(e,n,r){return t.debounce(e,n,r,!0)},t.curry=function(e,n,r,i){return null==n&&(n=[]),null==i&&(i=!1),e="function"==typeof e?e:r[e],n=t.to_a(n),function(){var t;return t=1<=arguments.length?p.call(arguments,0):[],e.apply(r||this,i?t.concat(n):n.concat(t))}},t.delayed=function(e,n,r,i){return null==r&&(r=[]),function(){return setTimeout(t.curry(n,r,i),e)}},t.after=function(e,n,r){return t.delayed(e,n,[],r)()},t}(),a=[["truthy",!0],["falsey",!1],["null",null],["pass",void 0]],o=function(t){var e,n;return e=t[0],n=t[1],i[e]=function(){return n}},s=0,u=a.length;u>s;s++)r=a[s],o(r);n.exports=i}}),require.define({"pieces-core/core/utils/browser":function(t,e,n){"use strict";var r,i,o,s,u,a,c;u=/\bMac OS X ([\d\._]+)\b/,c=/\bWindows NT ([\d\.]+)\b/,o=/(iphone|ipod|ipad)/i,s=/\bcpu\s*(?:iphone\s+)?os ([\d\.\-_]+)\b/i,i=/\bandroid[\s\-]([\d\-\._]+)\b/i,a={6.3:"8.1",6.2:"8",6.1:"7","6.0":"Vista",5.2:"XP",5.1:"XP"},r=function(){function t(){}return t.scrollbar_width=function(){return this._scrollbar_width||(this._scrollbar_width=function(){var t,e,n;return t=document.createElement("div"),e=t.style,e.position="absolute",e.width="100px",e.height="100px",e.overflow="scroll",e.top="-9999px",document.body.appendChild(t),n=t.offsetWidth-t.clientWidth,document.body.removeChild(t),n}())},t.info=function(){return this._info||(this._info=null!=window.bowser?this._extend_info(window.bowser):this._extend_info()),this._info},t._extend_info=function(t){return null==t&&(t={}),t.os=this.os(),t},t.os=function(){return this._os||(this._os=function(){var t,e,n;return e={},n=window.navigator.userAgent,n.indexOf("Windows")>-1?(e.windows=!0,(t=c.exec(n))&&(e.version=a[t[1]])):n.indexOf("Macintosh")>-1?(e.macos=!0,(t=u.exec(n))&&(e.version=t[1])):n.indexOf("X11")>-1?e.unix=!0:(t=o.exec(n))?(e[t[1]]=!0,(t=s.exec(n))&&(e.version=t[1])):n.indexOf("Android")>-1?(e.android=!0,(t=i.exec(n))&&(e.version=t[1])):n.indexOf("Tizen")>-1?e.tizen=!0:n.indexOf("Blackberry")>-1&&(e.blackberry=!0),e.version&&(e.version=e.version.replace(/(_|\-)/g,".")),e}())},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/func":function(t,e,n){"use strict";var r,i,o=[].slice;i=e("./base"),r=function(){function t(){}return t.BREAK="__BREAK__",t.wrap=function(e,n,r,i){return null==i&&(i={}),function(){var s,u,a,c,l;if(u=1<=arguments.length?o.call(arguments,0):[],l=i["this"]||this,null!=n){if(a=n.apply(l,u),a&&i.break_if_value===!0)return a;if(a===t.BREAK)return i.break_with}return c=e.apply(l,u),null!=r&&(s=r.call(l,c,u,a)),c}},t.append=function(e,n,r){return null==r&&(r={}),t.wrap(e,null,n,r)},t.prepend=function(e,n,r){return null==r&&(r={}),t.wrap(e,n,null,r)},t.unwrap=function(t,e,n){return null==e&&(e={}),null==n&&(n=null),function(){return null!=e.debounce?i.debounce(e.debounce,t,n||this):null!=e.throttle?i.throttle(e.throttle,t,n||this):t.bind(n||this)}},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/history":function(t,e,n){"use strict";var r;r=function(){function t(t){this.limit=null!=t?t:10,this._storage=[],this._position=-1}return t.prototype.push=function(t){return this._position<-1&&(this._storage.splice(this._storage.length+this._position+1,-this._position+1),this._position=-1),this._storage.push(t),this._storage.length>this.limit?this._storage.shift():void 0},t.prototype.prev=function(){return-this._position<this._storage.length?(this._position-=1,this._storage[this._storage.length+this._position]):void 0},t.prototype.next=function(){return this._position>-2?void 0:(this._position+=1,this._storage[this._storage.length+this._position])},t.prototype.size=function(){return this._storage.length},t.prototype.clear=function(){return this._storage.length=0,this._position=-1},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/index":function(t,e,n){"use strict";var r=e("./base");r.arr=e("./arr"),r.obj=e("./obj"),r.promise=e("./promise"),r.func=e("./func"),r.browser=e("./browser"),r.time=e("./time"),e("./logger"),r.matchers=e("./matchers"),n.exports=r}}),require.define({"pieces-core/core/utils/logger":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l=[].slice;o=e("./base"),e("./browser"),e("./time"),r=o.browser.info(),u=r.msie?function(t,e){console.log("["+t+"]",e)}:window.mochaPhantomJS?function(t,e){}:function(t,e){console.log("%c "+o.time.now("%H:%M:%S:%L")+" ["+t+"]","color: "+a[t].color,e)},window.console&&window.console.log||(window.console={log:function(){}}),o.log_level||(o.log_level="info"),a={error:{color:"#dd0011",sort:4},debug:{color:"#009922",sort:0},debug_verbose:{color:"#eee",sort:-1},info:{color:"#1122ff",sort:1},warning:{color:"#ffaa33",sort:2}},c=function(t){return a[o.log_level].sort<=a[t].sort},o.log=function(){var t,e;return t=arguments[0],e=2<=arguments.length?l.call(arguments,1):[],c(t)&&u(t,e)};for(i in a)s=a[i],o[i]=o.curry(o.log,i);n.exports=o.log}}),require.define({"pieces-core/core/utils/matchers":function(t,e,n){"use strict";var r,i,o,s,u=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},a={}.hasOwnProperty;i=e("./base"),s={"?":function(t){return function(e){return u.call(t,e)>=0}},"?&":function(t){return function(e){var n,r,i;for(r=0,i=t.length;i>r;r++)if(n=t[r],!(u.call(e,n)>=0))return!1;return!0}},">":function(t){return function(e){return e>=t}},"<":function(t){return function(e){return t>=e}},"~":function(t){return"string"==typeof t&&(t=new RegExp(i.escapeRegexp(t))),function(e){return t.test(e)}}},o=/^([\w\d_]+)(\?&|>|<|~|\?)$/,r=function(){function t(){}return t.object=function(t,e){var n,r,i;null==e&&(e=!0),i=function(n){return function(r,i){return null==i?t[r]=function(t){return!t}:"object"==typeof i?t[r]=n.object(i,e):"function"!=typeof i?t[r]=function(t){return i===t}:void 0}}(this);for(n in t)r=t[n],i(n,r);return function(r){var i,o;if(null==r)return!1;o=!1;for(n in t)if((i=t[n])(r[n])){if(o=!0,!e)return o}else if(e)return!1;return o}},t.nod=function(t){var e,n,r,i;return t.indexOf(":")>0?(i=t.split(":"),r=i[0],e=i[1],n=new RegExp(e,"i"),r=r.split(","),function(t){var e,i,o,s;for(i=0,o=r.length;o>i;i++)if(e=r[i],null!=(s=t.find(e))?s.text().match(n):void 0)return!0;return!1}):(n=new RegExp(t,"i"),function(t){return!!t.text().match(n)})},t.object_ext=function(t,e){var n,r,i,u;null==e&&(e=!0),r={};for(n in t)a.call(t,n)&&(u=t[n],null==u||"object"!=typeof u||Array.isArray(u)?(i=n.match(o))?r[i[1]]=s[i[2]](u):r[n]=u:r[n]=this.object_ext(u,e));return this.object(r,e)},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/obj":function(t,e,n){"use strict";var r,i;i=e("./base"),r=function(){function t(){}return t.get_path=function(t,e){var n,r,i;for(r=e.split("."),i=t;r.length;){if(n=r.shift(),null==i[n])return;i=i[n]}return i},t.set_path=function(t,e,n){var r,i,o;for(i=e.split("."),o=t;i.length>1;)r=i.shift(),null==o[r]&&(o[r]={}),o=o[r];return o[i[0]]=n},t.get_class_path=function(t,e){return e=e.split(".").map(function(t){return function(t){return i.camelCase(t)}}(this)).join("."),this.get_path(t,e)},t.set_class_path=function(t,e,n){return e=e.split(".").map(function(t){return function(t){return i.camelCase(t)}}(this)).join("."),this.set_path(t,e,n)},t.wrap=function(t,e){var n;return n={},n[t]=e,n},t.from_arr=function(t){var e,n,r,i,o;for(e={},n=i=0,o=t.length;o>i;n=i+=2)r=t[n],e[t[n]]=t[n+1];return e},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/promise":function(t,e,n){"use strict";var r,i;i=e("./base"),r=function(){function t(){}return t.resolved=function(t){return new Promise(function(e){return e(t)})},t.rejected=function(t){return new Promise(function(e,n){return n(t)})},t.delayed=function(t,e,n){return null==n&&(n=!1),new Promise(function(r,o){return i.after(t,function(){return n?o(e):r(e)})})},t.as=function(e){return t.is(e)?e:t.resolved(e)},t.is=function(t){return t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then},t}(),n.exports=r}}),require.define({"pieces-core/core/utils/time":function(t,e,n){"use strict";var r,i,o,s;s=/%[a-zA-Z]/g,o=function(t,e){var n;for(null==e&&(e=1),n=10;e;)n>t&&(t="0"+t),n*=10,e--;return t},i={H:function(t){return o(t.getHours())},k:function(t){return t.getHours()},I:function(t){return o(i.l(t))},l:function(t){var e;return e=t.getHours(),e>12?e-12:e},M:function(t){return o(t.getMinutes())},S:function(t){return o(t.getSeconds())},L:function(t){return o(t.getMilliseconds(),2)},z:function(t){var e,n;return e=t.getTimezoneOffset(),n=e>0?"-":"+",e=Math.abs(e),n+o(Math.floor(e/60))+":"+o(e%60)},Y:function(t){return t.getFullYear()},y:function(t){return(t.getFullYear()+"").slice(2)},m:function(t){return o(t.getMonth()+1)},d:function(t){return o(t.getDate())},e:function(t){return t.getDate()},P:function(t){return t.getHours()>11?"PM":"AM"},p:function(t){return i.P(t).toLowerCase()}},r=function(){function t(){}return t.add_formatter=function(t,e){return i[t]=e},t.parse=function(t){return"number"==typeof t&&4e9>t&&(t*=1e3),new Date(t)},t.now=function(t){return this.format(new Date,t)},t.format=function(t,e){return t=this.parse(t),null==e?t:e.replace(s,function(e){var n;return n=e.slice(1),i[n]?i[n](t):e})},t.duration=function(t,e,n){var r,i,s,u;return null==e&&(e=!1),null==n&&(n=!1),e&&(s=t%1e3,t=t/1e3|0),r=[],i=t/60|0,r.push(i/60|0),r.push(o(i%60)),r.push(o(t%60)),u=r.join(":"),null!=s&&n&&(u+="."+o(s,2)),u},t}(),n.exports=r}}),require.define({"pieces-core/grammar/compiler":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l=[].slice;o=e("./pi_grammar").parser,s=e("../core/utils"),u=function(t){return s.error("Function ["+t+"] was compiled with error"),!1},a={">":">","<":"<","=":"=="},r=function(){function t(t,e){var n;if(this.target=null!=t?t:{},"string"==typeof e){this.fun_str=e;try{this._parsed=this.constructor.parse(this.fun_str)}catch(r){n=r,this._compiled=s.curry(r,[this.fun_str])}}else this.fun_str="parsed",this._parsed=e}return t.parse=function(t){return o.parse(t)},t.compile=function(t){var e;return e=this["_get_"+t.code](t,"__res = "),e="var _ref, __res;\n"+e+";\nreturn __res;\n//# sourceURL=/pi_compiled/source_"+this.fun_str+"_"+s.uid()+'";\n',new Function(e)},t.prototype.call=function(){var t,e;return e=arguments[0],t=2<=arguments.length?l.call(arguments,1):[],this.apply(e,t)},t.prototype.apply=function(t,e){return this.call_ths=t||{},this.compiled().apply(this,e)},t.prototype.compiled=function(){return this._compiled||(this._compiled=this.constructor.compile(this._parsed))},t._get_chain=function(t,e){var n,r,i;for(null==e&&(e=""),n=t.value[0],e+="prop"===n.code||"res"===n.code?function(){switch(n.name){case"this":return"this.target";case"app":return"pi.app";case"host":return"this.target.host";case"view":return"this.target.view";case"window":return"window";default:return"(function(){\n  _ref = ("+this["_get_"+n.code](n,"this.call_ths")+");\n  if(!(_ref == void 0)) return _ref;\n  _ref = this.target.scoped && ("+this["_get_"+n.code](n,"this.target.scope")+");\n  if(this.target.scoped && !(_ref == void 0)) return _ref;\n\n  return ("+this["_get_"+n.code](n,"window")+");\n}).call(this)"}}.call(this):"(function(){\n  _ref = "+this._get_safe_call(n,"this.call_ths")+";\n  if(!(_ref == void 0)) return _ref;\n  _ref = this.target.scoped && "+this._get_safe_call(n,"this.target.scope.scope")+";\n  if(this.target.scoped && !(_ref == void 0)) return _ref;\n  _ref = this.target.scoped && "+this._get_safe_call(n,"this.target")+";\n  if(!(_ref == void 0)) return _ref;\n  return "+this._get_safe_call(n,"window")+";\n}).call(this)",r=1;r<t.value.length;)i=t.value[r++],e=this["_get_"+i.code](i,e,t.value[r-1]);return e},t._get_res=function(t,e,n){return null==e&&(e=""),"res"===(null!=n?n.code:void 0)?e+("."+t.name):"window.pi.resources."+t.name},t._get_prop=function(t,e){return null==e&&(e=""),e+("."+t.name)},t._get_call=function(t,e){return null==e&&(e=""),e+("."+t.name+"("+this._get_args(t.args).join(", ")+")")},t._get_safe_call=function(t,e){var n;return null==e&&(e=""),n=""+e+"['"+t.name+"']","((typeof "+n+" === 'function') ? "+n+"("+this._get_args(t.args).join(", ")+") : null)"},t._get_args=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this["_get_"+e.code](e));return i},t._get_op=function(t,e){var n,r,i;return null==e&&(e=""),n=t.left,r=t.right,i="="===t.type?"==":t.type,e+="("+this["_get_"+n.code](n)+") "+i+" ("+this["_get_"+r.code](r)+")"},t._get_if=function(t,e){return null==e&&(e=""),e+="(function(){",e+="if("+this["_get_"+t.cond.code](t.cond)+")",e+="{\n  return ("+this["_get_"+t.left.code](t.left)+");\n}",null!=t.right&&(e+="else{ return ("+this["_get_"+t.right.code](t.right)+");}"),e+="}).call(this);"},t._get_simple=function(t,e){return null==e&&(e=""),e+this._quote(t.value)},t._quote=function(t){return"string"==typeof t?"'"+t+"'":t&&"object"==typeof t?"JSON.parse('"+JSON.stringify(t)+"')":t},t}(),i=function(){function t(){}return t.modifiers=[],t.parse=function(t){return o.parse(this.process_modifiers(t))},t.compile=function(t){return r.compile(t)},t.traverse=function(t,e){var n,r,i,o,s,u,a,c,l;if(e.call(null,t),"op"===t.code||"if"===t.code){if(this.traverse(t.left,e),this.traverse(t.right,e),"if"===t.code)return this.traverse(t.cond,e)}else{if("chain"===t.code){for(u=t.value,c=[],r=0,o=u.length;o>r;r++)n=u[r],c.push(this.traverse(n,e));return c}if("call"===t.code){for(a=t.args,l=[],i=0,s=a.length;s>i;i++)n=a[i],l.push(this.traverse(n,e));return l}}},t.process_modifiers=function(t){var e,n,r,i;for(i=this.modifiers,n=0,r=i.length;r>n;n++)e=i[n],t=e.call(null,t);return t},t.compile_fun=function(t,e){return"string"==typeof t&&(t=this.process_modifiers(t)),new r(e,t)},t.str_to_fun=t.compile_fun,t.str_to_event_handler=function(t,e){var n;return n=this.compile_fun(t,e),function(t){return n.call({e:t})}},t}(),c=function(t){return t.replace(/@(this|app|host|view)(\b)/g,"$1$2").replace(/@@/g,"pi.app.page.context.").replace(/@/g,"pi.app.view.")},i.modifiers.push(c),n.exports=i}}),require.define({"pieces-core/grammar/pi_grammar":function(t,e,n){var r=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,group_e:6,ternary:7,cond:8,simple_e:9,"(":10,object:11,")":12,method_chain:13,val:14,OP:15,OP2:16,OP3:17,method:18,".":19,resource:20,key:21,args:22,RES:23,KEY:24,",":25,key_val:26,":":27,NUMBER:28,BOOL:29,STRING:30,TIF:31,TELSE:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:"cond",10:"(",12:")",15:"OP",16:"OP2",17:"OP3",19:".",23:"RES",24:"KEY",25:",",27:":",28:"NUMBER",29:"BOOL",30:"STRING",31:"TIF",32:"TELSE"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,3],[6,3],[9,1],[9,1],[9,3],[9,3],[9,3],[13,1],[13,3],[18,1],[18,1],[18,4],[20,4],[20,4],[20,1],[21,1],[22,3],[22,3],[22,1],[22,1],[22,0],[11,3],[11,1],[26,3],[14,1],[14,1],[14,1],[7,5]],performAction:function(t,e,r,i,o,s,u){var a=s.length-1;switch(o){case 1:return s[a-1];case 2:this.$=s[a];break;case 3:this.$=s[a];break;case 4:this.$=s[a];break;case 5:this.$=s[a];break;case 6:this.$={code:"simple",value:n(s[a-1])};break;case 7:this.$=s[a-1];break;case 8:this.$={code:"chain",value:s[a]};break;case 9:this.$={code:"simple",value:s[a]};break;case 10:this.$={code:"op",left:s[a-2],right:s[a],type:s[a-1].trim()};break;case 11:this.$={code:"op",left:s[a-2],right:s[a],type:s[a-1].trim()};break;case 12:this.$={code:"op",left:s[a-2],right:s[a],type:s[a-1].trim()};break;case 13:this.$=s[a];break;case 14:this.$=s[a-2].concat(s[a]);break;case 15:this.$=s[a];break;case 16:this.$=[{code:"prop",name:s[a]}];break;case 17:this.$=[{code:"call",name:s[a-3],args:s[a-1]}];break;case 18:this.$=[{code:"res",name:s[a-3]},{code:"call",name:"view",args:[{code:"simple",value:n(s[a-1])}]}];break;case 19:this.$=[{code:"res",name:s[a-3]},{code:"call",name:"get",args:[{code:"simple",value:s[a-1]}]}];break;case 20:this.$=[{code:"res",name:s[a]}];break;case 21:this.$=t;break;case 22:this.$=[s[a-2]].concat(s[a]);break;case 23:this.$=[s[a-2]].concat(s[a]);break;case 24:this.$=[s[a]];break;case 25:this.$=[{code:"simple",value:n(s[a])}];break;case 26:this.$=[];break;case 27:this.$=s[a-2].concat(s[a]);break;case 28:this.$=s[a];break;case 29:this.$=[s[a-2],s[a]];break;case 30:this.$=Number(t);break;case 31:this.$="true"==t;break;case 32:this.$=t.replace(/(^['"]|['"]$)/g,"");break;case 33:this.$={code:"if",cond:s[a-4],left:s[a-2],right:s[a]}}},table:[{3:1,4:2,6:3,7:4,8:[1,5],9:6,10:[1,7],13:8,14:9,18:10,20:14,21:15,23:[1,16],24:[1,17],28:[1,11],29:[1,12],30:[1,13]},{1:[3]},{5:[1,18]},{5:[2,2],12:[2,2],32:[2,2]},{5:[2,3],12:[2,3],32:[2,3]},{5:[2,4],12:[2,4],32:[2,4]},{5:[2,5],12:[2,5],15:[1,20],16:[1,21],17:[1,22],31:[1,19],32:[2,5]},{4:24,6:3,7:4,8:[1,5],9:6,10:[1,7],11:23,13:8,14:9,18:10,20:14,21:26,23:[1,16],24:[1,17],26:25,28:[1,11],29:[1,12],30:[1,13]},{5:[2,8],12:[2,8],15:[2,8],16:[2,8],17:[2,8],25:[2,8],31:[2,8],32:[2,8]},{5:[2,9],12:[2,9],15:[2,9],16:[2,9],17:[2,9],25:[2,9],31:[2,9],32:[2,9]},{5:[2,13],12:[2,13],15:[2,13],16:[2,13],17:[2,13],19:[1,27],25:[2,13],31:[2,13],32:[2,13]},{5:[2,30],12:[2,30],15:[2,30],16:[2,30],17:[2,30],25:[2,30],31:[2,30],32:[2,30]},{5:[2,31],12:[2,31],15:[2,31],16:[2,31],17:[2,31],25:[2,31],31:[2,31],32:[2,31]},{5:[2,32],12:[2,32],15:[2,32],16:[2,32],17:[2,32],25:[2,32],31:[2,32],32:[2,32]},{5:[2,15],12:[2,15],15:[2,15],16:[2,15],17:[2,15],19:[2,15],25:[2,15],31:[2,15],32:[2,15]},{5:[2,16],10:[1,28],12:[2,16],15:[2,16],16:[2,16],17:[2,16],19:[2,16],25:[2,16],31:[2,16],32:[2,16]},{5:[2,20],10:[1,29],12:[2,20],15:[2,20],16:[2,20],17:[2,20],19:[2,20],25:[2,20],31:[2,20],32:[2,20]},{5:[2,21],10:[2,21],12:[2,21],15:[2,21],16:[2,21],17:[2,21],19:[2,21],25:[2,21],27:[2,21],31:[2,21],32:[2,21]},{1:[2,1]},{4:30,6:3,7:4,8:[1,5],9:6,10:[1,7],13:8,14:9,18:10,20:14,21:15,23:[1,16],24:[1,17],28:[1,11],29:[1,12],30:[1,13]},{9:31,13:8,14:9,18:10,20:14,21:15,23:[1,16],24:[1,17],28:[1,11],29:[1,12],30:[1,13]},{9:32,13:8,14:9,18:10,20:14,21:15,23:[1,16],24:[1,17],28:[1,11],29:[1,12],30:[1,13]},{9:33,13:8,14:9,18:10,20:14,21:15,23:[1,16],24:[1,17],28:[1,11],29:[1,12],30:[1,13]},{12:[1,34]},{12:[1,35]},{12:[2,28],25:[1,36]},{10:[1,28],12:[2,16],15:[2,16],16:[2,16],17:[2,16],19:[2,16],25:[2,16],27:[1,37],31:[2,16]},{13:38,18:10,20:14,21:15,23:[1,16],24:[1,17]},{4:42,6:40,7:4,8:[1,5],9:41,10:[1,7],11:43,12:[2,26],13:8,14:9,18:10,20:14,21:26,22:39,23:[1,16],24:[1,17],26:25,28:[1,11],29:[1,12],30:[1,13]},{11:44,14:45,21:46,24:[1,17],26:25,28:[1,11],29:[1,12],30:[1,13]},{32:[1,47]},{5:[2,10],12:[2,10],15:[2,10],16:[1,21],17:[1,22],25:[2,10],31:[2,10],32:[2,10]},{5:[2,11],12:[2,11],15:[2,11],16:[2,11],17:[1,22],25:[2,11],31:[2,11],32:[2,11]},{5:[2,12],12:[2,12],15:[2,12],16:[2,12],17:[2,12],25:[2,12],31:[2,12],32:[2,12]},{5:[2,6],12:[2,6],32:[2,6]},{5:[2,7],12:[2,7],25:[2,7],32:[2,7]},{11:48,21:46,24:[1,17],26:25},{14:49,28:[1,11],29:[1,12],30:[1,13]},{5:[2,14],12:[2,14],15:[2,14],16:[2,14],17:[2,14],25:[2,14],31:[2,14],32:[2,14]},{12:[1,50]},{12:[2,2],25:[1,51]},{12:[2,5],15:[1,20],16:[1,21],17:[1,22],25:[1,52],31:[1,19]},{12:[2,24]},{12:[2,25]},{12:[1,53]},{12:[1,54]},{27:[1,37]},{4:55,6:3,7:4,8:[1,5],9:6,10:[1,7],13:8,14:9,18:10,20:14,21:15,23:[1,16],24:[1,17],28:[1,11],29:[1,12],30:[1,13]},{12:[2,27]},{12:[2,29],25:[2,29]},{5:[2,17],12:[2,17],15:[2,17],16:[2,17],17:[2,17],19:[2,17],25:[2,17],31:[2,17],32:[2,17]},{4:42,6:40,7:4,8:[1,5],9:41,10:[1,7],11:43,12:[2,26],13:8,14:9,18:10,20:14,21:26,22:56,23:[1,16],24:[1,17],26:25,28:[1,11],29:[1,12],30:[1,13]},{4:42,6:40,7:4,8:[1,5],9:41,10:[1,7],11:43,12:[2,26],13:8,14:9,18:10,20:14,21:26,22:57,23:[1,16],24:[1,17],26:25,28:[1,11],29:[1,12],30:[1,13]},{5:[2,18],12:[2,18],15:[2,18],16:[2,18],17:[2,18],19:[2,18],25:[2,18],31:[2,18],32:[2,18]},{5:[2,19],12:[2,19],15:[2,19],16:[2,19],17:[2,19],19:[2,19],25:[2,19],31:[2,19],32:[2,19]},{5:[2,33],12:[2,33],32:[2,33]},{12:[2,22]},{12:[2,23]}],defaultActions:{18:[2,1],42:[2,24],43:[2,25],48:[2,27],56:[2,22],57:[2,23]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||p,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,r=[0],i=[null],o=[],s=this.table,u="",a=0,c=0,l=0,h=2,p=1,_=o.slice.call(arguments,1);this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;o.push(f);var d=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var y,v,g,m,b,w,x,k,E,O={};;){if(g=r[r.length-1],this.defaultActions[g]?m=this.defaultActions[g]:((null===y||"undefined"==typeof y)&&(y=e()),m=s[g]&&s[g][y]),"undefined"==typeof m||!m.length||!m[0]){var z="";E=[];for(w in s[g])this.terminals_[w]&&w>h&&E.push("'"+this.terminals_[w]+"'");z=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(a+1)+": Unexpected "+(y==p?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(z,{text:this.lexer.match,token:this.terminals_[y]||y,line:this.lexer.yylineno,loc:f,expected:E})}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+y);switch(m[0]){case 1:r.push(y),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),r.push(m[1]),y=null,v?(y=v,v=null):(c=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,f=this.lexer.yylloc,l>0&&l--);break;case 2:if(x=this.productions_[m[1]][1],O.$=i[i.length-x],O._$={first_line:o[o.length-(x||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(x||1)].first_column,last_column:o[o.length-1].last_column},d&&(O._$.range=[o[o.length-(x||1)].range[0],o[o.length-1].range[1]]),b=this.performAction.apply(O,[u,c,a,this.yy,m[1],i,o].concat(_)),"undefined"!=typeof b)return b;x&&(r=r.slice(0,-1*x*2),i=i.slice(0,-1*x),o=o.slice(0,-1*x)),r.push(this.productions_[m[1]][0]),i.push(O.$),o.push(O._$),k=s[r[r.length-2]][r[r.length-1]],r.push(k);break;case 3:return!0}}return!0}},n=function(t){for(var e={},n=0,r=t.length;r>n;n+=2)e[t[n]]=t[n+1];return e},r=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"");

},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,r;this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if(n=this._input.match(this.rules[i[o]]),n&&(!e||n[0].length>e[0].length)){if(e=n,r=o,this.options.backtrack_lexer){if(t=this.test_match(n,i[o]),t!==!1)return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?(t=this.test_match(e,i[r]),t!==!1?t:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){var t=this.conditionStack.length-1;return t>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:break;case 1:return 28;case 2:return 32;case 3:return 27;case 4:return 31;case 5:return"?";case 6:return 25;case 7:return 10;case 8:return 12;case 9:return 30;case 10:return 30;case 11:return 29;case 12:return 23;case 13:return 24;case 14:return 19;case 15:return 15;case 16:return 16;case 17:return 17;case 18:return 5;case 19:return"INVALID"}},rules:[/^(?:\s\s+)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:\s+:\s+)/,/^(?::\s*)/,/^(?:\s+\?\s+)/,/^(?:\?)/,/^(?:,\s*)/,/^(?:\()/,/^(?:\))/,/^(?:"(\\"|[^\"])*")/,/^(?:'(\\'|[^\'])*')/,/^(?:(true|false))/,/^(?:[A-Z][\w\d]*)/,/^(?:\w[\w\d]*)/,/^(?:\.)/,/^(?:\s*(=|>=|>|<|<=)\s*)/,/^(?:\s*(\+|-)\s*)/,/^(?:\s*(\/|\*)\s*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],inclusive:!0}}};return t}();return e.lexer=r,t.prototype=e,e.Parser=t,new t}();"undefined"!=typeof e&&"undefined"!=typeof t&&(t.parser=r,t.Parser=r.Parser,t.parse=function(){return r.parse.apply(r,arguments)},t.main=function(n){n[1]||(console.log("Usage: "+n[0]+" FILE"),process.exit(1));var r=e("fs").readFileSync(e("path").normalize(n[1]),"utf8");return t.parser.parse(r)},"undefined"!=typeof n&&e.main===n&&t.main(process.argv.slice(1)))}}),require.define({"pieces-core/index":function(t,e,n){"use strict";var r=e("./core");r.Compiler=e("./grammar/compiler"),r.components=e("./components"),r["export"](r.components,"$c");var i=e("./components/base"),o=e("./components/modules/renderable");i.include(o),r.klass=e("./components/utils/klass"),r.renderers=e("./renderers"),r.Plugin=e("./plugins"),r.Net=e("./net"),r.resources=e("./resources"),r["export"](r.resources,"$r"),r.controllers=e("./controllers"),r.views=e("./views"),r.Initializer=e("./components/utils/initializer"),e("./controllers/initializer"),r.Guesser=e("./components/utils/guesser"),r.$=e("./components/utils/setup"),r["export"](r.$,"$");var s=e("./core/app");r.app=new s,n.exports=window.pi=r}}),require.define({"pieces-core/net/iframe.upload":function(t,e,n){"use strict";var r,i,o;i=e("../core/nod").Nod,o=e("../core/utils"),r=function(){function t(){}return t._build_iframe=function(t){var e;return e=i.create("iframe"),e.attrs({id:t,name:t,width:0,height:0,border:0}),e.styles({width:0,height:0,border:"none"}),e},t._build_input=function(t,e){var n;return n=i.create("input"),n.node.type="hidden",n.node.name=t,n.node.value=e,n},t._build_form=function(t,e,n,r,i){var o,s,u;for(t.attrs({target:e,action:r,method:i,enctype:"multipart/form-data",encoding:"multipart/form-data"}),s=0,u=n.length;u>s;s++)o=n[s],t.append(this._build_input(o.name,o.value));return t.append(this._build_input("__iframe__",e)),t},t.upload=function(t,e,n,r){return new Promise(function(s){return function(u){var a,c;return c="iframe_"+o.uid(),a=s._build_iframe(c),t=s._build_form(t,c,n,e,r),i.body.append(a),a.on("load",function(){var t;return"complete"===a.node.contentDocument.readyState?(t=a.node.contentDocument.getElementsByTagName("body")[0],o.after(500,function(){return a.remove()}),a.off(),u(t)):void 0}),t.node.submit()}}(this))},t}(),n.exports=r}}),require.define({"pieces-core/net/index":function(t,e,n){"use strict";n.exports=e("./net")}}),require.define({"pieces-core/net/net":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h={}.hasOwnProperty;for(u=e("../core/utils"),r=e("./iframe.upload"),o=e("../core/nod").Nod,i=function(){function t(){}return t._prepare_response=function(t){var e,n;return n=t.getResponseHeader("Content-Type"),e=/json/.test(n)?JSON.parse(t.responseText):t.responseText,u.debug("XHR response",t.responseText),e},t._prepare_error=function(t){var e,n;return n=t.getResponseHeader("Content-Type"),e=/json/.test(n)?JSON.parse(t.responseText||'{"status":'+t.statusText+"}"):t.responseText||t.statusText},t._is_app_error=function(t){return t>=400&&500>t},t._is_success=function(t){return t>=200&&300>t||304===t},t._with_prefix=function(t,e){return t?""+t+"["+e+"]":e},t._to_params=function(t,e){var n,r,i,o,s,u;if(null==e&&(e=""),i=[],null==t)return i;if("object"!=typeof t)i.push({name:e,value:t});else if(t instanceof Date)i.push({name:e,value:t.getTime()});else if(t instanceof Array)for(e+="[]",s=0,u=t.length;u>s;s++)n=t[s],i=i.concat(this._to_params(n,e));else if(window.File&&(t instanceof File||t instanceof Blob))i.push({name:e,value:t});else for(r in t)h.call(t,r)&&(o=t[r],i=i.concat(this._to_params(o,this._with_prefix(e,r))));return i},t._data_to_query=function(t){var e,n,r,i,o;for(n=[],o=this._to_params(t),r=0,i=o.length;i>r;r++)e=o[r],n.push(""+e.name+"="+encodeURIComponent(e.value));return n.join("&")},t._data_to_form=window.FormData?function(e){var n,r,i,o,s;for(n=new FormData,s=t._to_params(e),i=0,o=s.length;o>i;i++)r=s[i],n.append(r.name,r.value);return n}:function(e){return t._data_to_query(e)},t.use_json=!0,t.headers=[],t.method_override=!1,t.request=function(t,e,n,r,i){return null==r&&(r={}),new Promise(function(o){return function(s,a){var c,l,p,_,f,d;p=i||new XMLHttpRequest,_=null!=r.json?r.json:o.use_json,d=u.merge(o.headers,r.headers||{}),"GET"===t?(l=o._data_to_query(n),l&&(e+=e.indexOf("?")<0?"?":"&",e+=""+l),n=null):(o.method_override===!0&&(n._method=t,d["X-HTTP-Method-Override"]=t,t="POST"),_?(d["Content-Type"]="application/json",null!=n&&(n=JSON.stringify(n))):n=o._data_to_form(n)),p.open(t,e,!0),p.withCredentials=!!r.withCredentials;for(c in d)h.call(d,c)&&(f=d[c],p.setRequestHeader(c,f));return d=null,"function"==typeof r.progress&&(p.upload.onprogress=function(t){return f=t.lengthComputable?100*t.loaded/t.total:0,r.progress(Math.round(f))}),p.onreadystatechange=function(){return 4===p.readyState?o._is_success(p.status)?s(o._prepare_response(p)):a(o._is_app_error(p.status)?Error(o._prepare_error(p)):Error("500 Internal Server Error")):void 0},p.onerror=function(){a(Error("Network Error"))},p.send(n)}}(this))},t.upload=function(t,e,n,r){var i;if(null==e&&(e={}),null==n&&(n={}),!this.XHR_UPLOAD)throw Error("File upload not supported");return i=n.method||"POST",n.json=!1,this.request(i,t,e,n,r)},t.iframe_upload=function(t,e,n,i){var s,u;if(null==n&&(n={}),null==i&&(i={}),s=null!=i.as_json?i.as_json:this.use_json,t instanceof o||(t=o.create(t)),null==t)throw Error("Form is undefined");return u=i.method||"POST",new Promise(function(i){return function(o,a){return r.upload(t,e,i._to_params(n),u).then(function(t){var e;return null==t&&a(Error("Response is empty")),s||o(t.innerHtml),t=function(){try{return JSON.parse(t.innerHTML)}catch(n){return e=n,JSON.parse(t.innerText)}}(),o(t)})["catch"](function(t){return a(t)})}}(this))},t}(),i.XHR_UPLOAD=!!window.FormData,i.IframeUpload=r,l=["get","post","patch","put","delete"],a=0,c=l.length;c>a;a++)s=l[a],i[s]=u.curry(i.request,[s.toUpperCase()],i);n.exports=i}}),require.define({"pieces-core/plugins/base/index":function(t,e,n){"use strict";e("./selectable")}}),require.define({"pieces-core/plugins/base/selectable":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=e("../../components/base"),o=e("../../components/utils/klass"),i=e("../../components/events"),s=e("../plugin"),u=e("../../core/utils"),r.Selectable=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.id="selectable",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),r.active_property(this.target,"selected",{type:"bool","default":this.target.hasClass(o.SELECTED),event:i.Selected,"class":o.SELECTED,functions:["select","deselect"],toggle_select:"toggle_select"}),this.target.on("click",this.click_handler()),this},e.prototype.click_handler=function(t){return this.target.enabled?(this.toggle_select(),!1):void 0},e.event_handler("click_handler"),e}(s),n.exports=r.Selectable}}),require.define({"pieces-core/plugins/index":function(t,e,n){"use strict";var r=e("./plugin");e("./base"),n.exports=r}}),require.define({"pieces-core/plugins/plugin":function(t,e,n){"use strict";var r,i,o,s={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=e("../core/core"),o=e("../core/utils"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.id="",e.included=function(t){var e;return e=this,t.after_initialize(function(){return this.attach_plugin(e)})},e.attached=function(t,e){return null==e&&(e={}),(new this).initialize(t,e)},e.prototype.initialize=function(t,e){return this.target=t,this.options=e,this.target[this.id]=this,this.target["has_"+this.id]=!0,this.target.addClass("has-"+this.id),this},e.prototype.dispose=o.truthy,e}(r),n.exports=i}}),require.define({"pieces-core/renderers/base":function(t,e,n){"use strict";var r,i,o,s;o=e("../core/nod").Nod,s=e("../core/utils"),i=e("../components/base"),r=function(){function t(){}return t.prototype.render=function(t,e,n){return t instanceof o?this._render(t,t.data(),e,n):void 0},t.prototype._render=function(t,e,n,r){return null==n&&(n=!0),t instanceof i||n&&(t=t.piecify(r)),t.record=e,t},t}(),n.exports=r}}),require.define({"pieces-core/renderers/index":function(t,e,n){"use strict";var r={};r.Base=e("./base"),r.Simple=e("./simple"),n.exports=r}}),require.define({"pieces-core/renderers/simple":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("../core/nod").Nod,s=e("../core/utils"),r=e("./base"),c=/\{\>\s*([^\}]+?)\s*\}[\s\S]+?\{\<\s*\1\s*\}/g,l=/\{\{([\s\S]+?)\}\}|\{\?([\s\S]+?)\?\}|\{\!([\s\S]+?)\!\}|$/g,u=/\\|'|\r|\n|\t|\u2028|\u2029/g,a={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},o=function(t){function e(t){var e;e=t.html().trim(),e.match(/^</)&&e.match(/>$/m)||(e="<div>"+e+"</div>"),this.create_templater(e)}return p(e,t),e.prototype.create_templater=function(t){var e,n;n=this._funstr(t,n);try{this.templater=new Function("__obj",n)}catch(r){throw e=r,e.source=n,e}},e.prototype.escape=function(t){return t?t.replace(u,function(t){return"\\"+a[t]}):t},e.prototype.to_hash=function(t){return t.split("").reduce(function(t,e){return t=(t<<5)-t+e.charCodeAt(0),t&t},0)},e.prototype.parse_conditional=function(t){var e,n;return n="",e=0,t.replace(/(['"][^'"]*['"])|$/g,function(r){return function(r,i,o){return n+=t.slice(e,o).replace(/\b([a-zA-Z][\w\(\)]*)\b/g,"__obj.$&"),e=o+r.length,i&&(n+=i),r}}(this)),n},e.prototype.render=function(t,n,r){var o;return t instanceof i?e.__super__.render.apply(this,arguments):(o=i.create(s.squish(this.templater(t))),this._render(o,t,n,r))},e.prototype._funstr=function(t){var e,n,r;return e=this.to_hash(t),n=0,r="",t=t.replace(c,function(t){return function(e){var n,i,o,u,a,c;return c=e.match(/^\{\>\s*(\w+)\s*\}([\s\S]*)\{\<\s*\w+\s*\}$/),a=c[0],o=c[1],n=c[2],u=t._funstr(n.trim()),i="_"+o+"_"+s.uid("partial"),r+="\nfunction "+i+"(__obj, $parent, $i, $key, $val){"+u+"};\n","{!\n  __ref = __obj."+o+"\n  if(Array.isArray(__ref)){\n    for(var i=0, len=__ref.length;i<len;i++){\n      __p+="+i+"(__ref[i], __obj, i, null, __ref[i]);\n    }\n  }else if(typeof __ref === 'object' && __ref){\n    for(var k in __ref){\n      if(!__ref.hasOwnProperty(k)) continue;\n      __p+="+i+"(__ref[k], __obj, null, k, __ref[k]);\n    }\n  }else if(__ref){\n    __p+="+i+"(__obj);\n  }\n!}"}}(this)),r+="\n__p+='",t.replace(l,function(e){return function(i,o,u,a,c){var l,h,p,_,f;return r+=e.escape(t.slice(n,c)),o&&(f=o.match(/^(\=)?\s*([\s\S]+?)\s*$/),_=f[0],l=f[1],p=f[2],h=p.match(/^\$(i|key|val|parent)/)?"":"__obj.",o=h+p,r+=l?"'+(((__t = "+o+") == void 0) ? '' : __t)+'":"'+(((__t = pi.utils.escapeHTML("+o+")) == void 0) ? '' : __t)+'"),u&&(u=u.indexOf(":")>0?u:u+" : ''",u=s.squish(u),r+="'+(((__t = "+e.parse_conditional(u)+") == void 0) ? '' : __t)+'"),a&&(r+="';\n"+a+";\n__p+='"),n=c+i.length,i}}(this)),r+="';",r="var __ref,__t,__p='';__obj = __obj || {};\n"+r+"\nreturn __p;\n//# sourceURL=/simpletemplates/source_"+e+'";\n'},e}(r),n.exports=o}}),require.define({"pieces-core/resources/association":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("./base"),s=e("./view"),o=e("./events"),u=e("../core/utils"),r=function(t){function e(t,n,r){this.resources=t,this.options=null!=r?r:{},e.__super__.constructor.apply(this,arguments),this._only_update=!1,this.owner=this.options.owner,this.options.belongs_to===!0?this.options.owner._persisted?this.owner_name_id=this.options.key:(this._only_update=!0,this.options.owner.one(o.Create,function(t){return function(){var e,n,r,i,o;for(t._only_update=!1,t.owner=t.options.owner,t.owner_name_id=t.options.key,i=t.__all__,n=0,r=i.length;r>n;n++)e=i[n],e.set(u.obj.wrap(t.owner_name_id,t.owner.id),!0);return t.options._scope!==!1?(t.options.scope=null!=(null!=(o=t.options._scope)?o[t.options.key]:void 0)?u.merge(t.options._scope,u.obj.wrap(t.options.key,t.owner.id)):u.obj.wrap(t.options.key,t.owner.id),t.reload()):void 0}}(this))):this.options.scope||(this._only_update=!0)}return c(e,t),e.prototype.clear_all=function(){return this.options.route&&(this.owner[""+this.options.name+"_loaded"]=!1),e.__super__.clear_all.apply(this,arguments)},e.prototype.reload=function(){return this.clear_all(),this.options.scope?(this._filter=u.matchers.object_ext(this.options.scope),this.load(this.resources.where(this.options.scope))):void 0},e.prototype.build=function(t,n,r){return null==t&&(t={}),null==n&&(n=!1),null==r&&(r={}),this.options.belongs_to===!0&&(null==t[this.owner_name_id]&&(t[this.owner_name_id]=this.owner.id),t instanceof i||(t=this.resources.build(t,!1))),e.__super__.build.call(this,t,n,r)},e.prototype.on_update=function(t){return this.get(t.id)?this.options.copy===!1?this.trigger(o.Update,this._wrap(t)):e.__super__.on_update.apply(this,arguments):this._only_update===!1?this.build(t):void 0},e.prototype.on_destroy=function(t){return this.options.copy===!1?(this.remove(t,!0,!1),this.trigger(o.Destroy,this._wrap(t))):e.__super__.on_destroy.apply(this,arguments)},e.prototype.on_create=function(t){var e;return(e=this.get(t.id)||this.get(t.__tid__))?(this.created(e,t.__tid__),this.options.copy===!1?this.trigger(o.Create,this._wrap(t)):e.set(t.attributes())):this._only_update?void 0:this.build(t)},e.prototype.on_load=function(){return this._only_update?void 0:this.options.scope?(this.load(this.resources.where(this.options.scope)),this.trigger(o.Load,{})):void 0},e}(s),u.extend(i,{views_cache:{},clear_cache:function(t){return null!=t?void delete this.views_cache[t]:this.views_cache={}},cache_view:function(t,e){var n;return n=this.cache_key_from_object(t),this.views_cache[this.cache_id()][n]=e},cached_view:function(t){var e;return e=this.cache_key_from_object(t),this.views_cache[this.cache_id()][e]},view:function(t,e){var n;return null==e&&(e=!0),e&&(n=this.cached_view(t))?n:(n=new r(this,t,{scope:t,copy:!1}),n.reload(),e&&this.cache_view(t,n),n)},cache_key_from_object:function(t){var e,n,r;return n=Object.keys(t).sort(),r=[function(){var r,i,o;for(o=[],r=0,i=n.length;i>r;r++)e=n[r],o.push(""+e+"_"+t[e]);return o}()],r.join(":")},cache_id:function(){var t,e;return this._cache_id||(this._cache_id=u.uid("res")),(t=this.views_cache)[e=this._cache_id]||(t[e]={}),this._cache_id}}),n.exports=r}}),require.define({"pieces-core/resources/base":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};i=e("../core/events").EventDispatcher,s=e("../core/utils"),o=e("./events"),u=function(t){return t.replace(/s$/,"")},r=function(t){function e(t){null==t&&(t={}),e.__super__.constructor.apply(this,arguments),this._snapshot=t,this.changes={},null==t.id||t.__temp__||(this._persisted=!0),this.initialize(t)}return c(e,t),e.set_resource=function(t,e){return this.__all_by_id__={},this.__all_by_tid__={},this.__all__=[],this.resources_name=t,this.resource_name=e||u(t)},e.register_association=function(t){return this.prototype.__associations__=null!=this.prototype.__associations__?this.prototype.__associations__.slice():[],this.prototype.__associations__.push(t)},e.load=function(t,e){var n,r;return null==e&&(e=!1),null!=t?(r=function(){var e,r,i;for(i=[],e=0,r=t.length;r>e;e++)n=t[e],i.push(this.build(n,!0));return i}.call(this),e||this.trigger(o.Load,{}),r):void 0},e.from_data=function(t){return null!=t[this.resource_name]&&(t[this.resource_name]=this.build(t[this.resource_name])),null!=t[this.resources_name]&&(t[this.resources_name]=this.load(t[this.resources_name])),t},e.clear_all=function(){var t,e,n,r;for(r=this.__all__,e=0,n=r.length;n>e;e++)t=r[e],t.dispose();return this.__all_by_id__={},this.__all_by_tid__={},this.__all__.length=0},e.get=function(t){return this.__all_by_id__[t]||this.__all_by_tid__[t]},e.get_by=function(t){var e,n,r,i;if(null!=t){for(i=this.__all__,n=0,r=i.length;r>n;n++)if(e=i[n],s.matchers.object_ext(t)(e))return e;return null}},e.add=function(t){return this.get(t.id)?void 0:(t.__temp__===!0?this.__all_by_tid__[t.id]=t:this.__all_by_id__[t.id]=t,this.__all__.push(t))},e.build=function(t,e,n){var r;return null==t&&(t={}),null==e&&(e=!1),null==n&&(n=!0),t.id&&(r=this.get(t.id))?r.set(t,e):(t.id||(t.id="tid_"+s.uid(),t.__temp__=!0),r=new this(t),n&&(this.add(r),e||r.__temp__||this.trigger(o.Create,this._wrap(r))),r)},e.created=function(t,e){return this.__all_by_tid__[e]?(delete this.__all_by_tid__[e],this.__all_by_id__[t.id]=t):void 0},e.clear_temp=function(t){var e,n,r;null==t&&(t=!1),r=this.__all_by_tid__;for(n in r)a.call(r,n)&&(e=r[n],this.remove(e,t));return this.__all_by_tid__={}},e.remove_by_id=function(t,e){var n;return n=this.get(t),null!=n&&this.remove(n),!1},e.remove=function(t,e,n){return null==n&&(n=!0),null!=this.__all_by_id__[t.id]?delete this.__all_by_id__[t.id]:delete this.__all_by_tid__[t.id],this.__all__.splice(this.__all__.indexOf(t),1),e||this.trigger(o.Destroy,this._wrap(t)),n&&t.dispose(),!0},e.listen=function(t,e){return i.Global.on(""+this.resources_name+"_update",t,null,e)},e.trigger=function(t,e,n){return e.type=t,e.changes=n,i.Global.trigger(""+this.resources_name+"_update",e,!1)},e.off=function(t){return null!=t?i.Global.off(""+this.resources_name+"_update",t):i.Global.off(""+this.resources_name+"_update")},e.all=function(){return this.__all__.slice()},e.first=function(){return this.__all__[0]},e.second=function(){return this.__all__[1]},e.last=function(){return this.__all__[this.__all__.length-1]},e.count=function(){return this.__all__.length},e.where=function(t){var e,n,r,i,o;for(i=this.__all__,o=[],n=0,r=i.length;r>n;n++)e=i[n],s.matchers.object_ext(t)(e)&&o.push(e);return o},e._wrap=function(t){return t instanceof e?s.obj.wrap(t.constructor.resource_name,t):t},e.prototype.initialize=function(t){return this._initialized?void 0:(this.set(t,!0),this._initialized=!0)},e.register_callback("initialize"),e.prototype.created=function(t){return this.commit(),this.constructor.created(this,t),this},e.prototype.commit=function(){var t,e,n,r,i;for(i=this.changes,e=n=0,r=i.length;r>n;e=++n)t=i[e],this._snapshot[t]=e[1];return this.changes={},this._snapshot},e.prototype.dispose=function(){var t,e;if(!this.disposed){for(t in this)a.call(this,t)&&(e=this[t],delete this[t]);return this.disposed=!0,this}},e.register_callback("dispose",{as:"destroy"}),e.prototype.remove=function(t){return null==t&&(t=!1),this.constructor.remove(this,t)},e.prototype.attributes=function(){var t,e,n,r;e={},r=this._snapshot;for(t in r)n=r[t],e[t]=this.changes[t]?this.changes[t][1]:n;return e},e.prototype.association=function(t){var e;return(null!=(e=this.__associations__)?e.indexOf(t):void 0)>-1},e.prototype.set=function(t,e){var n,r,i,s,u,c;s=!1,c=!(!this.id||this.__temp__===!0),u=this.id;for(n in t)a.call(t,n)&&(i=t[n],this[n]===i||"function"==typeof this[n]||null!=this.__associations__&&l.call(this.__associations__,n)>=0||(s=!0,this.changes[n]=[this[n],i],this[n]=i));return 0|this.id&&!c?(delete this.__temp__,this._persisted=!0,this.__tid__=u,r=o.Create,this.created(u)):r=o.Update,s&&!e&&this.trigger(r,r===o.Create?this:this.changes),this},e.register_callback("set",{as:"update"}),e.prototype.trigger=function(t,n,r){return null==r&&(r=!1),e.__super__.trigger.apply(this,arguments),this.constructor.trigger(t,this.constructor._wrap(this),n)},e.prototype.trigger_assoc_event=function(t,e,n){return"function"==typeof this["on_"+t+"_update"]&&this["on_"+t+"_update"].call(this,e,n),this.trigger(o.Update,s.obj.wrap(t,!0))},e}(i),r.Event=o,n.exports=r}}),require.define({"pieces-core/resources/events":function(t,e,n){"use strict";var r;r={Update:"update",Create:"create",Destroy:"destroy",Load:"load"},n.exports=r}}),require.define({"pieces-core/resources/index":function(t,e,n){"use strict";var r=e("../core/utils"),i={};i.Base=e("./base"),i.View=e("./view"),i.Association=e("./association"),i.REST=e("./rest"),r.extend(i,e("./modules")),e("./utils/binding"),n.exports=i}}),require.define({"pieces-core/resources/modules/has_many":function(t,e,n){"use strict";var r,i,o,s,u,a,c={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=e("../../core/core"),u=e("../events"),a=e("../../core/utils"),r=e("../association"),i=e("../base"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.has_many=function(t,e){var n,o;if(null==e)throw Error("Has many require at least 'source' param");return a.extend(e,{path:":resources/:id/"+t,method:"get"}),this.register_association(t),"function"==typeof e.update_if?o=e.update_if:e.update_if===!0&&(o=a.truthy),this.getter(t,function(){var n,i;return null==this["__"+t+"__"]&&(i={name:t,owner:this},e.belongs_to===!0&&(i.key=e.key||""+this.constructor.resource_name+"_id",null==e.copy&&(i.copy=!1),i._scope=e.scope,n=a.obj.wrap(i.key,this.id),i.scope=null==e.scope?this._persisted?n:!1:e.scope,null!=e.params&&e.params.push(""+this.constructor.resource_name+"_id")),a.extend(i,e),this["__"+t+"__"]=new r(e.source,i.scope,i),i.scope!==!1&&this["__"+t+"__"].load(e.source.where(i.scope)),e.update_if&&this["__"+t+"__"].listen(function(n){return function(r){var i;return i=r.data[e.source.resources_name]||r.data[e.source.resource_name],o(r.data.type,i)?n.trigger_assoc_event(t,r.data.type,i):void 0}}(this))),this["__"+t+"__"]}),e.route===!0&&(this.routes({member:[{action:"load_"+t,path:e.path,method:e.method}]}),this.prototype["on_load_"+t]=function(e){return this[""+t+"_loaded"]=!0,null!=e[t]?this[t].load(e[t]):void 0}),this.after_update(function(e){return e instanceof i?void 0:e[t]?(this[""+t+"_loaded"]=!0,this[t].load(e[t])):void 0}),this.after_initialize(function(){return this[t]}),e.destroy===!0&&this.before_destroy(function(){return this[t].clear_all(!0)}),e.attribute===!0?(n=this.prototype.attributes,this.prototype.attributes=function(){var e;return e=n.call(this),e[t]=this[t].serialize(),e}):void 0},e}(o),n.exports=s}}),require.define({"pieces-core/resources/modules/has_one":function(t,e,n){"use strict";var r,i,o,s,u,a={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("../../core/core"),s=e("../events"),u=e("../../core/utils"),r=e("../base"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.has_one=function(t,e){var n,i,o,a;if(null==e)throw Error("Has one require at least 'source' param");return e.foreign_key||(e.foreign_key=""+this.resource_name+"_id"),i=e.source.resource_name,n="bind_"+t,this.register_association(t),a="function"==typeof e.update_if?e.update_if:e.update_if===!0?u.truthy:u.falsey,e.source.listen(function(r){return function(o){var c,l,h,p,_,f;if(r.all().length){if(o=o.data,o.type===s.Load){for(_=e.source.all(),f=[],h=0,p=_.length;p>h;h++)c=_[h],f.push(c[e.foreign_key]&&(l=r.get(c[e.foreign_key]))&&l.association(t)?l[n](c):void 0);return f}return c=o[i],c[e.foreign_key]&&(l=r.get(c[e.foreign_key]))&&l.association(t)&&(o.type===s.Destroy?delete r[t]:o.type===s.Create&&l[n](c,!0),a(o,c))?l.trigger_assoc_event(t,o.type,u.obj.wrap(t,r[t])):void 0}}}(this)),this.prototype[n]=function(n,r){return null==r&&(r=!1),null!=n?(this[t]=n,this._persisted&&!this[t][e.foreign_key]&&(this[t][e.foreign_key]=this.id),!r&&a(null,n)?this.trigger_assoc_event(t,s.Create,u.obj.wrap(t,this[t])):void 0):void 0},this.after_initialize(function(){var t;return this._persisted&&(t=e.source.get_by(u.obj.wrap(e.foreign_key,this.id)))?this[n](t,!0):void 0}),this.after_update(function(i){var o;if(!(i instanceof r))return this._persisted&&!this[t]&&(o=e.source.get_by(u.obj.wrap(e.foreign_key,this.id)))&&this[n](o,!0),i[t]?this[t]instanceof r?this[t].set(i[t]):this[n](e.source.build(i[t])):void 0}),e.destroy===!0&&this.before_destroy(function(){var e;return null!=(e=this[t])?e.remove():void 0}),e.attribute===!0?(o=this.prototype.attributes,this.prototype.attributes=function(){var e;return e=o.call(this),e[t]=this[t].attributes(),e}):void 0},e}(i),n.exports=o}}),require.define({"pieces-core/resources/modules/index":function(t,e,n){"use strict";var r={};r.HasMany=e("./has_many"),r.HasOne=e("./has_one"),n.exports=r}}),require.define({"pieces-core/resources/rest":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l,h,p={}.hasOwnProperty,_=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f=[].slice;r=e("./base"),i=e("../core/events").EventDispatcher,u=e("./events"),a=e("../core/utils"),o=e("../net"),l=/:\w+/g,c=/\/\//,h=/\/$/,s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return _(e,t),e._rscope="/:path",e._globals={},e.prototype.wrap_attributes=!1,e.can_create=function(){var t;return t=1<=arguments.length?f.call(arguments,0):[],this.__deps__=(this.__deps__||(this.__deps__=[])).concat(t)},e.params=function(){var t;return t=1<=arguments.length?f.call(arguments,0):[],this.prototype.hasOwnProperty("__filter_params__")||(this.prototype.__filter_params__=[],this.prototype.__filter_params__.push("id")),this.prototype.__filter_params__=this.prototype.__filter_params__.concat(t)},e.set_resource=function(t,n){return e.__super__.constructor.set_resource.apply(this,arguments),this.routes({collection:[{action:"show",path:":resources/:id",method:"get"},{action:"fetch",path:":resources",method:"get"}],member:[{action:"update",path:":resources/:id",method:"patch"},{action:"__destroy",path:":resources/:id",method:"delete"},{action:"create",path:":resources",method:"post"}]}),this.prototype.destroy_path=":resources/:id"},e.set_globals=function(t){return a.extend(this._globals,t,!0)},e.routes=function(t){var e,n,r,i,o,s,u,c,l;if(null!=t.collection)for(u=t.collection,n=function(t){return function(e){return t[e.action]=function(t){return null==t&&(t={}),this._request(e.path,e.method,t).then(function(t){return function(n){var r,i,o,s;if(null!=t.__deps__)for(s=t.__deps__,i=0,o=s.length;o>i;i++)r=s[i],r.from_data(n);return null!=t["on_"+e.action]?t["on_"+e.action](n):t.on_all(n)}}(this))},t[""+e.action+"_path"]=e.path}}(this),r=0,o=u.length;o>r;r++)e=u[r],n(e);if(null!=t.member){for(c=t.member,l=[],i=0,s=c.length;s>i;i++)e=c[i],l.push(function(t){return function(e){return t.prototype[e.action]=function(t){return null==t&&(t={}),this.constructor._request(e.path,e.method,a.merge(t,{id:this.id}),this).then(function(t){return function(n){var r,i,o,s;if(null!=t.constructor.__deps__)for(s=t.constructor.__deps__,i=0,o=s.length;o>i;i++)r=s[i],r.from_data(n);return null!=t["on_"+e.action]?t["on_"+e.action](n):t.on_all(n)}}(this))},t.prototype[""+e.action+"_path"]=e.path}}(this)(e));return l}},e.routes_namespace=function(t){return this._rscope=t},e._interpolate_path=function(t,e,n){var r;return t=this._rscope.replace(":path",t).replace(c,"/").replace(h,""),r=this.prototype.wrap_attributes&&null!=e[this.resource_name]&&"object"==typeof e[this.resource_name]?a.extend(e[this.resource_name],e,!1,[this.resource_name]):e,t.replace(l,function(t){return function(e){var i,o,s;return i=e.slice(1),null!=(o=null!=(s=r[i])?s:null!=n?n[i]:void 0)?o:t._globals[i]}}(this))},e.on_error=function(t,e){return i.Global.trigger("net_error",{resource:this.resources_name,action:t,message:e})},e._request=function(t,e,n,r){return t=this._interpolate_path(t,a.merge(n,{resources:this.resources_name,resource:this.resource_name}),r),o[e].call(null,t,n)["catch"](function(t){return function(e){throw t.on_error(e.message),e}}(this))},e.on_all=function(t){return this.from_data(t)},e.on_show=function(t){
return this.from_data(t),t[this.resource_name]},e.find=function(t){var e;return e=this.get(t),null!=e?a.promise.resolved(e):this.show({id:t})},e.find_by=function(t){var e;return e=this.get_by(t),null!=e?a.promise.resolved(e):this.show(t)},e.create=function(t){var e;return e=this.build(t),e.save()},e.path=function(t,e,n){var r;return null==e&&(e={}),r=this[""+t+"_path"]||this.prototype[""+t+"_path"]||t,this._interpolate_path(r,e,n)},e.prototype.destroy=function(){return this._persisted?this.__destroy():a.promise.resolved(this.remove())},e.prototype.on_destroy=function(t){return this.constructor.remove(this),t},e.alias("on___destroy","on_destroy"),e.prototype.on_all=function(t){var e;return e=t[this.constructor.resource_name],null!=e&&(this.set(e),t[this.constructor.resource_name]=this),t},e.prototype.attributes=function(){return this.__attributes__changed__&&(this.__attributes__=this.__filter_params__?a.extract(this,this.__filter_params__):e.__super__.attributes.apply(this,arguments)),this.__attributes__},e.prototype.set=function(){return this.__attributes__changed__=!0,e.__super__.set.apply(this,arguments)},e.prototype.save=function(t){var e;return null==t&&(t={}),e=this.attributes(),a.extend(e,t,!0),e=this.wrap_attributes?this._wrap(e):e,this._persisted?this.update(e):this.create(e)},e.prototype.rollback=function(){var t,e,n,r,i;for(i=this.changes,e=n=0,r=i.length;r>n;e=++n)t=i[e],this[t]=this._snapshot[t];return this.changes={},this},e.register_callback("save"),e.prototype.path=function(t,e){return this.constructor.path(t,e,this)},e.prototype._wrap=function(t){return a.obj.wrap(this.constructor.resource_name,t)},e}(r),n.exports=s}}),require.define({"pieces-core/resources/utils/binding":function(t,e,n){"use strict";var r,i,o,s,u,a,c,l={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=e("../../core/utils"),i=e("../../core/binding").BindListener,s=e("../events"),r=e("../base"),a=e("../view"),o=e("../../core/core"),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.handle_resource_view=function(t,e,n,r){return null!=t&&this.listeners.push.apply(this.listeners,t.listen(this._update)),!0},e.prototype.handle_resource=function(t,e,n){return null==n&&(n=!1),c.debug("resource",t,e,n),n?this.listeners.push.apply(this.listeners,t.on(s.Destroy,function(t){return function(){return t.dispose()}}(this))):null!=t&&this.listeners.push.apply(this.listeners,t.on(s.Destroy,this._disable)),null!=t&&this.listeners.push.apply(this.listeners,t.on([s.Update,s.Create],this._update)),!0},e}(o),i.prepend_type("resource",function(t){return t instanceof r||t instanceof a.ViewItem}),i.prepend_type("resource_view",function(t){return t instanceof a}),i.include(u),n.exports=i}}),require.define({"pieces-core/resources/view":function(t,e,n){"use strict";var r,i,o,s,u,a,c={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=e("../core/events").EventDispatcher,a=e("../core/utils"),o=e("./events"),r=e("./base"),u=function(t){function e(t,n,r){this.view=t,this.options=null!=r?r:{},e.__super__.constructor.apply(this,arguments),null!=this.options.params&&this.options.params.indexOf("id")<0&&this.options.params.push("id"),this.changes={},this.set(n,!0)}return l(e,t),a.extend(e.prototype,r.prototype,!1),e.prototype.created=function(t){return this.view.created(this,t)},e.prototype.trigger=function(t,n,r){return null==r&&(r=!0),e.__super__.trigger.apply(this,arguments),this.view.trigger(t,this.view._wrap(this))},e.prototype.attributes=function(){var t;return null!=this.options.params?(t=a.extract(this,this.options.params),null!=this.options.id_alias&&(this.options.id_alias&&(t[this.options.id_alias]=t.id),delete t.id),t):r.prototype.attributes.call(this)},e}(i),s=function(t){function e(t,n,r){this.resources=t,this.options=null!=r?r:{},e.__super__.constructor.apply(this,arguments),this.__all_by_id__={},this.__all_by_tid__={},this.__all__=[],this.resources_name=this.resources.resources_name,this.resource_name=this.resources.resource_name,this._filter=null!=n&&n!==!1?a.matchers.object_ext(n):a.truthy,this.resources.listen(function(t){return function(e){var n,r;return n=e.data[t.resource_name],(null==n||t._filter(n))&&"function"==typeof t[r="on_"+e.data.type]?t[r](n):void 0}}(this))}return l(e,t),a.extend(e.prototype,r),e.prototype.on_update=function(t){var e;return(e=this.get(t.id))?e.set(t.attributes()):void 0},e.prototype.on_destroy=function(t){var e;return(e=this.get(t.id))?this.remove(e):void 0},e.prototype.clear_all=function(t){var e,n,r,i,o,s,u;if(null==t&&(t=!1),this.options.copy!==!1||t!==!1)if(t&&!this.options.copy)for(this.__all_by_id__={},this.__all_by_tid__={},s=this.__all__,n=0,i=s.length;i>n;n++)e=s[n],e.remove();else for(u=this.__all__,r=0,o=u.length;o>r;r++)e=u[r],e.dispose();return this.__all_by_id__={},this.__all_by_tid__={},this.__all__.length=0},e.prototype.build=function(t,e,n){var i;return null==t&&(t={}),null==e&&(e=!1),null==n&&(n={}),(i=this.get(t.id))?i.set(t,e):(t instanceof r&&this.options.copy===!1?i=t:(t instanceof r&&(t=t.attributes()),a.extend(t,n,!0),i=new u(this,t,this.options)),i.id&&(this.add(i),e||this.trigger(o.Create,this._wrap(i))),i)},e.prototype._wrap=function(t){return t instanceof u?a.obj.wrap(t.view.resource_name,t):t instanceof r?a.obj.wrap(t.constructor.resource_name,t):t},e.prototype.serialize=function(){var t,e,n,r,i;for(e=[],i=this.all(),n=0,r=i.length;r>n;n++)t=i[n],e.push(t.attributes());return e},e.prototype.listen=function(t){return this.on("update",t)},e.prototype.trigger=function(t,n){return n.type=t,e.__super__.trigger.call(this,"update",n)},e.prototype.off=function(t){return e.__super__.off.call(this,"update",t)},e}(i),s.ViewItem=u,n.exports=s}}),require.define({"pieces-core/views/base":function(t,e,n){"use strict";var r,i,o,s={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=e("../core/utils"),i=e("../components/base"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.is_view=!0,e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments)},e.prototype.postinitialize=function(){return this.init_modules(),e.__super__.postinitialize.apply(this,arguments)},e.prototype.init_modules=function(){var t,e,n,r;n=this.options.modules,r=[];for(t in n)e=n[t],r.push(this.mixin(this.constructor.lookup_module(t)));return r},e.prototype.loaded=function(t){},e.prototype.activated=function(t){},e.prototype.deactivated=function(){},e.prototype.unloaded=function(){},e}(i),o.extend(i.prototype,{context:function(){var t;return this.__controller__||(this.__controller__=null!=(t=this.view())?t.controller:void 0)},_find_view:function(){var t;for(t=this;t;){if(t.is_view===!0)return t;t=t.host}}}),i.getter("view",function(){return this.__view__||(this.__view__=this._find_view())}),n.exports=r}}),require.define({"pieces-core/views/index":function(t,e,n){"use strict";var r={};r.Base=e("./base"),n.exports=r}});